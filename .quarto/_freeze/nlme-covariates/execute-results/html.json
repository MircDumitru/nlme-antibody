{
  "hash": "3d2f3e4fb5c923bed3cc613b50a38dfc",
  "result": {
    "engine": "knitr",
    "markdown": "## Non-linear mixed effects (NLME) model - covariates\n\n\n::: content-hidden\n$$\n\\newcommand{\\ab}{\\bm{a}}\n\\newcommand{\\Ab}{\\bm{A}}\n\\newcommand{\\arv}{\\mathrm{a}}\n\\newcommand{\\arvb}{\\mathbf{a}}\n\\newcommand{\\Arvb}{\\mathbf{A}}\n\n\\newcommand{\\bb}{\\bm{b}}\n\\newcommand{\\Bb}{\\bm{B}}\n\\newcommand{\\brv}{\\mathrm{b}}\n\\newcommand{\\brvb}{\\mathbf{b}}\n\\newcommand{\\Brvb}{\\mathbf{B}}\n\n\\newcommand{\\eb}{\\bm{e}}\n\\newcommand{\\Eb}{\\bm{E}}\n\\newcommand{\\erv}{\\mathrm{e}}\n\\newcommand{\\ervh}{\\widehat{\\mathrm{e}}}\n\\newcommand{\\ervb}{\\mathbf{e}}\n\\newcommand{\\Ervb}{\\mathbf{E}}\n\n\\newcommand{\\sb}{\\bm{s}}\n\\newcommand{\\Sb}{\\bm{S}}\n\\newcommand{\\srv}{\\mathrm{s}}\n\\newcommand{\\srvh}{\\widehat{\\mathrm{s}}}\n\\newcommand{\\srvb}{\\mathbf{s}}\n\\newcommand{\\Srv}{\\mathrm{S}}\n\\newcommand{\\Srvb}{\\mathbf{S}}\n\n\\newcommand{\\tb}{\\bm{t}}\n\\newcommand{\\Tb}{\\bm{T}}\n\\newcommand{\\trv}{\\mathrm{t}}\n\\newcommand{\\trvb}{\\mathbf{t}}\n\\newcommand{\\Trvb}{\\mathbf{T}}\n\n\\newcommand{\\ub}{\\bm{u}}\n\\newcommand{\\Ub}{\\bm{U}}\n\\newcommand{\\urv}{\\mathrm{u}}\n\\newcommand{\\urvb}{\\mathbf{u}}\n\\newcommand{\\Urvb}{\\mathbf{U}}\n\n\\newcommand{\\yb}{\\bm{y}}\n\\newcommand{\\Yb}{\\bm{Y}}\n\\newcommand{\\yrv}{\\mathrm{y}}\n\\newcommand{\\yrvh}{\\widehat{\\mathrm{y}}}\n\\newcommand{\\yrvb}{\\mathbf{y}}\n\\newcommand{\\Yrvb}{\\mathbf{Y}}\n\n\\newcommand{\\xb}{\\bm{x}}\n\\newcommand{\\Xb}{\\bm{X}}\n\\newcommand{\\xrv}{\\mathrm{x}}\n\\newcommand{\\xrvb}{\\mathbf{x}}\n\\newcommand{\\Xrvb}{\\mathbf{X}}\n\n\\newcommand{\\zb}{\\bm{z}}\n\\newcommand{\\Zb}{\\bm{Z}}\n\\newcommand{\\zrv}{\\mathrm{z}}\n\\newcommand{\\zrvb}{\\mathbf{z}}\n\\newcommand{\\Zrvb}{\\mathbf{Z}}\n\n\\newcommand{\\Ib}{\\bm{I}}\n\n\\newcommand{\\oneb}{\\bm{1}}\n\\newcommand{\\zerob}{\\bm{0}}\n\n\\newcommand{\\sigmah}{\\widehat{\\sigma}}\n\\newcommand{\\epsilonb}{\\bm{\\epsilon}}\n\\newcommand{\\epsilonh}{\\widehat{\\epsilon}}\n\\newcommand{\\tauh}{\\widehat{\\tau}}\n\\newcommand{\\taus}{\\tau^{*}}\n\\newcommand{\\taush}{\\widehat{\\tau}^{*}}\n\\newcommand{\\alphah}{\\widehat{\\alpha}}\n\\newcommand{\\alphas}{\\alpha^{*}}\n\\newcommand{\\alphash}{\\widehat{\\alpha}^{*}}\n\\newcommand{\\nuh}{\\widehat{\\nu}}\n\\newcommand{\\betab}{\\bm{\\beta}}\n\\newcommand{\\psib}{\\bm{\\psi}}\n\\newcommand{\\xib}{\\bm{\\xi}}\n\\newcommand{\\thetab}{\\bm{\\theta}}\n\\newcommand{\\betah}{\\widehat{\\beta}}\n\\newcommand{\\betas}{\\beta^{*}}\n\\newcommand{\\betabh}{\\widehat{\\betab}}\n\\newcommand{\\betabsh}{\\widehat{\\betab}^{*}}\n\\newcommand{\\betabst}{\\betab^{*T}}\n\\newcommand{\\betabht}{\\widehat{\\betab}^{T}}\n\n\\def\\PD#1{\\mathbb{P} \\left( #1 \\right)}\n\\def\\cond{\\,\\middle\\vert\\,}\n\\def\\indep{\\perp \\!\\!\\!\\! \\perp}\n\\def\\Abs#1{\\left\\lvert\\ #1 \\right\\rvert}\n\\def\\EV#1{\\mathbb{E}\\left[#1\\right]}\n\\def\\EVp#1#2{\\mathbb{E}^{#1}\\left[#2\\right]}\n\\def\\ExV#1#2{\\mathbb{E}_{#1}\\left[#2\\right]}\n\\def\\ExVa#1#2#3{\\mathbb{E}_{#1}^{#2}\\left[#3\\right]}\n\\def\\Var#1{\\mathbb{V}\\left[#1\\right]}\n\\def\\Varh#1{\\widehat{\\mathbb{V}}\\left[#1\\right]}\n\\def\\VarRV#1#2{\\mathbb{V}_{#1}\\left[#2\\right]}\n\\def\\VarhRV#1#2{\\widehat{\\mathbb{V}}_{#1}\\left[#2\\right]}\n\\def\\VarRVh#1#2{\\widehat{\\mathbb{V}}_{#1}\\left[#2\\right]}\n\\def\\Cov#1{\\text{Cov}\\left[#1\\right]}\n\\def\\CovRV#1#2{\\text{Cov}_{#1}\\left[#2\\right]}\n\\def\\d#1{\\text{d}#1}\n\n\\def\\bias#1{\\text{bias}\\left[#1\\right]}\n\\def\\MSE#1{\\text{MSE}\\left(#1\\right)}\n\\def\\MSEh#1{\\widehat{\\text{MSE}}\\left(#1\\right)}\n\n\n\\def\\transpose#1{#1^{\\mathrm{T}}}\n\\def\\Normal#1{\\mathcal N \\left( #1 \\right)}\n\n\\usepackage{amsmath} \n\\usepackage{amsthm} \n\\usepackage{units}\n\\usepackage{bm}\n\\usepackage{bbm}\n\\usepackage{enumitem}\n\\usepackage{mathabx}\n\n\n$$\n:::\n\n\n::: {.cell}\n\n:::\n\n\n## Introduction\n\n### Prerequisites\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)  # tidyverse \nlibrary(nlme)       # non-linear mixed effect models\nlibrary(saemix)     # nlme package for saemix objects\n```\n:::\n\n\n\n## NLME with covariates\n\nThe decay rate $\\phi_3$ is assumed to depend on `age` through a linear relationship on the log scale, i.e. \n\n$$\n\\begin{equation}\n\\log(\\psi^{i}_3)\n=\n\\log(\\psi_3)\n+\n\\beta_{\\text{age}}\n\\left(\n\\text{age}_i\n-\n\\overline{\\text{age}}\n\\right)\n+\n\\nu_{3}\n.\n\\end{equation}\n$${#eq-log-scale-regression-age}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ntb <- read_csv(\"data/data_ebola_ab.csv\")\n\ntb <- tb |>\n  # clean the names\n  janitor::clean_names() |>\n  # transform chr into factors\n  mutate(across(where(is.character), fct))\n\ntb_clean <- tb |>\n  filter(age >= 0)\n\ntb_clean <- tb_clean |>\n  mutate(age_updated = age + time / 365) |>\n  relocate(age_updated, .after = age)\n\ntb_after_7 <- tb_clean |>\n  filter(time != 0)\n```\n:::\n\n\nThe next chunk is centering the age.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Centering the age covariate \ntb_after_7 <- tb_after_7 |>\n  mutate(age_centered = age - mean(age, na.rm = TRUE))\n```\n:::\n\n\nThe next chunk implements the function from @eq-f-approx\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nfunction_approx <- function(psi, id, xidep) {\n  time <- xidep[, 1]\n  y_min <- psi[id, 1]\n  y_max <- psi[id, 2]\n  rate  <- psi[id, 3]\n  fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n  return(fpred)\n}\n```\n:::\n\n\nThe next chunk is defining the data as a `saemix` object, via `saemixData()` function.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nsaemix_data_nlme <- saemixData(\n  name.data = tb_after_7,\n  name.group = \"id\",\n  name.predictors = \"time\",\n  name.response = \"abelisa\",\n  name.covariates = \"age_centered\",\n  units = list(x = \"Days\", y = \"EU/ml\")\n)\n#> Using the object called tb_after_7 in this R session as the data.\n#> [1] \"age_centered\"\n#> \n#> \n#> The following SaemixData object was successfully created:\n#> \n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     Predictor: time (Days) \n#>     covariates: age_centered (-)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_data_nlme\n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     covariates: age_centered (-) \n#> 301     observations in 43 subjects\n#> First lines of data:\n#>     id time  abelisa age_centered mdv cens occ ytype\n#> 1  ID1    7 4.434471    -8.574021   0    0   1     1\n#> 2  ID1   15 4.124822    -8.574021   0    0   1     1\n#> 3  ID1   30 4.050954    -8.574021   0    0   1     1\n#> 4  ID1   90 3.382073    -8.574021   0    0   1     1\n#> 5  ID1  180 2.935390    -8.574021   0    0   1     1\n#> 6  ID1  365 2.606559    -8.574021   0    0   1     1\n#> 7  ID1  730 2.308632    -8.574021   0    0   1     1\n#> 8  ID2    7 3.664922    -2.119769   0    0   1     1\n#> 9  ID2   15 4.143873    -2.119769   0    0   1     1\n#> 10 ID2   30 3.967767    -2.119769   0    0   1     1\n```\n:::\n\n\nThe next chunk is defining the nlme model as a `saemix` object, via `saemixModel()` function. The model is given by @eq-f-approx, the initial values for $\\psi_1$ and $\\psi_2$ are set via the range computed over the complete data and the rate $\\psi_3$ is set at $0.05$. The model considers random effects on all three parameters & constant variance, `error.model = \"constant\"`. Covariate (`age`) is considered to have an effect over the rate.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\npsi0_matrix <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.0, 0.01), # covariate effect on rate only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\ncovariate_model_matrix <- matrix(\n  data = c(0, 0, 1),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age_centered\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>              y_min y_max rate\n#> age_centered     0     0    1\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6   4.9 0.05\n#> Cov.CondInit   0.0   0.0 0.01\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_model_nlme\n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate \n#>      3 parameters: y_min y_max rate \n#>      error model: constant \n#>      covariate model:\n#>              y_min y_max rate\n#> age_centered     0     0    1\n```\n:::\n\n\n\nThe next chunk is defining the nlme modelâ€™s parameters as a (regular R) list (this doesn't change with respect to the no covariates model's implementation).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nsaemix_options_nlme <- list(\n  seed = 42,\n  save = FALSE,\n  save.graph = FALSE,\n  displayProgress = FALSE,\n  print = FALSE\n)\n```\n:::\n\n\nThe next chunk is fitting the nlme model, a `saemix` object, created via `saemix()` function.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nsaemix_fit_nlme <- saemix(\n  saemix_model_nlme,\n  saemix_data_nlme,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Fixed effects and covariate effects\nsaemix_fit_nlme@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter               Estimate   SE      CV(%) p-value\n#>  y_min                    2.73088 0.051108   1.87 -      \n#>  y_max                    4.24200 0.050202   1.18 -      \n#>  rate                     0.00936 0.000786   8.40 -      \n#>  beta_age_centered(rate) -0.00238 0.003976 167.23 0.275  \n#>  a.                       0.25627 0.012989   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0703   0.0210  29.8 \n#>  omega2.y_max 0.0618   0.0204  33.0 \n#>  omega2.rate  0.0339   0.0482 142.1 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 150.6239 \n#>        AIC= 166.6239 \n#>        BIC= 180.7135 \n#> Likelihood computed by importance sampling\n#>       -2LL= 150.7865 \n#>        AIC= 166.7865 \n#>        BIC= 180.8761\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Fixed effects and covariate effects\nsaemix_fit_nlme@results@fixed.effects\n#> [1]  2.730882113  4.241999871  0.009355897 -0.002377555\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nfit_with_preds <- saemix.predict(saemix_fit_nlme)\ntb_data <- fit_with_preds@data@data\ntb_predictions <- fit_with_preds@results@predictions\n\ntb_complete <- cbind(tb_data, tb_predictions)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ntb_complete |>\n  filter(id == 1) |>\nggplot(aes(x = time)) +\n  geom_point(aes(y = abelisa, color = \"Observed\"), size = 2) +\n  geom_line(aes(y = ipred, color = \"Individual prediction\"), linewidth = 1.5) +\n  geom_line(aes(y = ypred, color = \"Population prediction\"), linewidth = 1.5, linetype = \"dashed\") +\n  scale_color_manual(\n    name = NULL,\n    values = c(\"Observed\" = \"tomato\", \"Individual prediction\" = \"darkseagreen\", \"Population prediction\" = \"violet\")\n  ) +\n  labs(\n    title = \"Subject 1: Observed vs. Predicted\",\n    x = \"Time (Days)\",\n    y = \"Antibody Level (EU/ml)\"\n  ) +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n#> Warning: No shared levels found between `names(values)` of the manual scale and the\n#> data's colour values.\n```\n\n::: {.cell-output-display}\n![](nlme-covariates_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=576}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(tb_complete, aes(x = time)) +\n  geom_point(aes(y = abelisa), color = \"tomato\", size = 2) +\n  geom_line(aes(y = ipred), color = \"darkseagreen\", linewidth = 1.5) +\n  geom_line(aes(y = ypred), color = \"violet\", linewidth = 1.5, linetype = \"dashed\") +\n  labs(\n    title = NULL,\n    x = NULL,\n    y = NULL\n  ) +\n  facet_wrap(~ id) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](nlme-covariates_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=1152}\n:::\n:::\n\n::: {#fig-fixed-effects-iterations .cell layout-ncol=\"3\" layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\npsi <- psi(saemix_fit_nlme) |>\n  as_tibble() |>\n  rowid_to_column(\"iteration\")\n\npsi |>\n  ggplot(aes(x = iteration, y = y_min)) +\n  geom_line(color = \"tomato\") +\n  labs(\n    x = \"Iteration\",\n    y = \"y_min\"    \n  ) +\n  theme_bw()\n\npsi |>\n  ggplot(aes(x = iteration, y = y_max)) +\n  geom_line(color = \"tomato\") +\n  labs(\n    x = \"Iteration\",\n    y = \"y_max\"    \n  ) +\n  theme_bw()\n\npsi |>\n  ggplot(aes(x = iteration, y = rate)) +\n  geom_line(color = \"tomato\") +\n  labs(\n    x = \"Iteration\",\n    y = \"rate\"    \n  ) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![y_min](nlme-covariates_files/figure-html/fig-fixed-effects-iterations-1.png){#fig-fixed-effects-iterations-1 fig-align='center' width=288}\n:::\n\n::: {.cell-output-display}\n![y_max](nlme-covariates_files/figure-html/fig-fixed-effects-iterations-2.png){#fig-fixed-effects-iterations-2 fig-align='center' width=288}\n:::\n\n::: {.cell-output-display}\n![rate](nlme-covariates_files/figure-html/fig-fixed-effects-iterations-3.png){#fig-fixed-effects-iterations-3 fig-align='center' width=288}\n:::\n\nFixed effects during iterations\n:::\n\n\n\n## Model selection\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Centering the bmi covariate \ntb_after_7 <- tb_after_7 |>\n  mutate(bmi_centered = bmi - mean(bmi, na.rm = TRUE))\n```\n:::\n\n\n\n### Age centered\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define models with main effects\nsaemix_data_nlme_age <- saemixData(\n  name.data = tb_after_7,\n  name.group = \"id\",\n  name.predictors = \"time\",\n  name.response = \"abelisa\",\n  name.covariates = \"age_centered\",\n  units = list(x = \"Days\", y = \"EU/ml\")\n)\n#> Using the object called tb_after_7 in this R session as the data.\n#> [1] \"age_centered\"\n#> \n#> \n#> The following SaemixData object was successfully created:\n#> \n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     Predictor: time (Days) \n#>     covariates: age_centered (-)\n\ncovariate_model_matrix_rate <- matrix(\n  data = c(0, 0, 1),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age_centered\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_rate <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.0, 0.01), # covariate effect on rate only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_rate <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_rate,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_rate,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>              y_min y_max rate\n#> age_centered     0     0    1\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6   4.9 0.05\n#> Cov.CondInit   0.0   0.0 0.01\n\nsaemix_fit_nlme_age_rate <- saemix(\n  saemix_model_nlme_rate,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter               Estimate   SE      CV(%) p-value\n#>  y_min                    2.73088 0.051108   1.87 -      \n#>  y_max                    4.24200 0.050202   1.18 -      \n#>  rate                     0.00936 0.000786   8.40 -      \n#>  beta_age_centered(rate) -0.00238 0.003976 167.23 0.275  \n#>  a.                       0.25627 0.012989   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0703   0.0210  29.8 \n#>  omega2.y_max 0.0618   0.0204  33.0 \n#>  omega2.rate  0.0339   0.0482 142.1 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 150.6239 \n#>        AIC= 166.6239 \n#>        BIC= 180.7135 \n#> Likelihood computed by importance sampling\n#>       -2LL= 150.7865 \n#>        AIC= 166.7865 \n#>        BIC= 180.8761\n\n#----\n\ncovariate_model_matrix_y_max <- matrix(\n  data = c(0, 1, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age_centered\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_max <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.01, 0.0), # covariate effect on y_max only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_max <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_max,\n  transform.par = c(0, 1, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_max,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     log-normal   Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>              y_min y_max rate\n#> age_centered     0     1    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6  4.90 0.05\n#> Cov.CondInit   0.0  0.01 0.00\n\nsaemix_fit_nlme_age_y_max <- saemix(\n  saemix_model_nlme_y_max,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter                Estimate   SE      CV(%) p-value\n#>  y_min                    2.726228 0.051339   1.88 -      \n#>  y_max                    4.231942 0.050271   1.19 -      \n#>  beta_age_centered(y_max) 0.000076 0.000578 760.47 0.448  \n#>  rate                     0.009198 0.000774   8.41 -      \n#>  a.                       0.255963 0.012980   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.0709   0.02113  29.8 \n#>  omega2.y_max 0.0035   0.00114  32.7 \n#>  omega2.rate  0.0350   0.04855 138.6 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.2787 \n#>        AIC= 167.2787 \n#>        BIC= 181.3683 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.4833 \n#>        AIC= 167.4833 \n#>        BIC= 181.5729\n\n#----\n\ncovariate_model_matrix_y_min <- matrix(\n  data = c(1, 0, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age_centered\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_min <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.01, 0.0, 0.0), # covariate effect on y_min only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_min <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_min,\n  transform.par = c(1, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_min,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     log-normal   Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>              y_min y_max rate\n#> age_centered     1     0    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit  1.60   4.9 0.05\n#> Cov.CondInit  0.01   0.0 0.00\n\nsaemix_fit_nlme_age_y_min <- saemix(\n  saemix_model_nlme_y_min,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter                Estimate    SE      CV(%) p-value\n#>  y_min                     2.717381 0.050796   1.87 -      \n#>  beta_age_centered(y_min) -0.000234 0.000898 383.62 0.397  \n#>  y_max                     4.242755 0.050256   1.18 -      \n#>  rate                      0.009375 0.000801   8.55 -      \n#>  a.                        0.256829 0.013033   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.00928  0.00281  30.3 \n#>  omega2.y_max 0.06173  0.02052  33.2 \n#>  omega2.rate  0.04454  0.05019 112.7 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.2472 \n#>        AIC= 167.2472 \n#>        BIC= 181.3368 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.642 \n#>        AIC= 167.642 \n#>        BIC= 181.7316\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter               Estimate   SE      CV(%) p-value\n#>  y_min                    2.73088 0.051108   1.87 -      \n#>  y_max                    4.24200 0.050202   1.18 -      \n#>  rate                     0.00936 0.000786   8.40 -      \n#>  beta_age_centered(rate) -0.00238 0.003976 167.23 0.275  \n#>  a.                       0.25627 0.012989   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0703   0.0210  29.8 \n#>  omega2.y_max 0.0618   0.0204  33.0 \n#>  omega2.rate  0.0339   0.0482 142.1 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 150.6239 \n#>        AIC= 166.6239 \n#>        BIC= 180.7135 \n#> Likelihood computed by importance sampling\n#>       -2LL= 150.7865 \n#>        AIC= 166.7865 \n#>        BIC= 180.8761\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter                Estimate   SE      CV(%) p-value\n#>  y_min                    2.726228 0.051339   1.88 -      \n#>  y_max                    4.231942 0.050271   1.19 -      \n#>  beta_age_centered(y_max) 0.000076 0.000578 760.47 0.448  \n#>  rate                     0.009198 0.000774   8.41 -      \n#>  a.                       0.255963 0.012980   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.0709   0.02113  29.8 \n#>  omega2.y_max 0.0035   0.00114  32.7 \n#>  omega2.rate  0.0350   0.04855 138.6 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.2787 \n#>        AIC= 167.2787 \n#>        BIC= 181.3683 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.4833 \n#>        AIC= 167.4833 \n#>        BIC= 181.5729\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter                Estimate    SE      CV(%) p-value\n#>  y_min                     2.717381 0.050796   1.87 -      \n#>  beta_age_centered(y_min) -0.000234 0.000898 383.62 0.397  \n#>  y_max                     4.242755 0.050256   1.18 -      \n#>  rate                      0.009375 0.000801   8.55 -      \n#>  a.                        0.256829 0.013033   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.00928  0.00281  30.3 \n#>  omega2.y_max 0.06173  0.02052  33.2 \n#>  omega2.rate  0.04454  0.05019 112.7 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.2472 \n#>        AIC= 167.2472 \n#>        BIC= 181.3368 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.642 \n#>        AIC= 167.642 \n#>        BIC= 181.7316\n```\n:::\n\n\n\n\n\n\n\n### Age \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define models with main effects\nsaemix_data_nlme_age <- saemixData(\n  name.data = tb_after_7,\n  name.group = \"id\",\n  name.predictors = \"time\",\n  name.response = \"abelisa\",\n  name.covariates = \"age\",\n  units = list(x = \"Days\", y = \"EU/ml\")\n)\n#> Using the object called tb_after_7 in this R session as the data.\n#> [1] \"age\"\n#> \n#> \n#> The following SaemixData object was successfully created:\n#> \n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     Predictor: time (Days) \n#>     covariates: age (-)\n\ncovariate_model_matrix_rate <- matrix(\n  data = c(0, 0, 1),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_rate <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.0, 0.01), # covariate effect on rate only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_rate <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_rate,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_rate,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> age     0     0    1\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6   4.9 0.05\n#> Cov.CondInit   0.0   0.0 0.01\n\nsaemix_fit_nlme_age_rate <- saemix(\n  saemix_model_nlme_rate,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter      Estimate   SE     CV(%) p-value\n#>  y_min           2.73426 0.05123   1.87 -      \n#>  y_max           4.24654 0.05062   1.19 -      \n#>  rate            0.01127 0.00223  19.83 -      \n#>  beta_age(rate) -0.00391 0.00403 103.16 0.166  \n#>  a.              0.25548 0.01297   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0715   0.0212  29.7 \n#>  omega2.y_max 0.0633   0.0208  32.8 \n#>  omega2.rate  0.0403   0.0496 123.3 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 150.7797 \n#>        AIC= 166.7797 \n#>        BIC= 180.8693 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.0107 \n#>        AIC= 167.0107 \n#>        BIC= 181.1003\n\n#----\n\ncovariate_model_matrix_y_max <- matrix(\n  data = c(0, 1, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_max <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.01, 0.0), # covariate effect on y_max only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_max <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_max,\n  transform.par = c(0, 1, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_max,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     log-normal   Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> age     0     1    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6  4.90 0.05\n#> Cov.CondInit   0.0  0.01 0.00\n\nsaemix_fit_nlme_age_y_max <- saemix(\n  saemix_model_nlme_y_max,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min           2.73e+00 0.051327   1.88 -      \n#>  y_max           4.22e+00 0.119334   2.83 -      \n#>  beta_age(y_max) 7.11e-05 0.000582 818.20 0.451  \n#>  rate            9.17e-03 0.000782   8.53 -      \n#>  a.              2.56e-01 0.012995   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.07065  0.02118  30.0 \n#>  omega2.y_max 0.00356  0.00116  32.6 \n#>  omega2.rate  0.04189  0.05034 120.2 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.6332 \n#>        AIC= 167.6332 \n#>        BIC= 181.7228 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.9172 \n#>        AIC= 167.9172 \n#>        BIC= 182.0068\n\n#----\n\ncovariate_model_matrix_y_min <- matrix(\n  data = c(1, 0, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"age\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_min <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.01, 0.0, 0.0), # covariate effect on y_min only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_min <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_min,\n  transform.par = c(1, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_min,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     log-normal   Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> age     1     0    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit  1.60   4.9 0.05\n#> Cov.CondInit  0.01   0.0 0.00\n\nsaemix_fit_nlme_age_y_min <- saemix(\n  saemix_model_nlme_y_min,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate    SE      CV(%) p-value\n#>  y_min            2.745738 0.119586   4.36 -      \n#>  beta_age(y_min) -0.000231 0.000896 388.46 0.398  \n#>  y_max            4.242183 0.050428   1.19 -      \n#>  rate             0.009373 0.000796   8.50 -      \n#>  a.               0.257262 0.013044   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.00925  0.0028  30.2 \n#>  omega2.y_max 0.06235  0.0206  33.1 \n#>  omega2.rate  0.04047  0.0494 122.1 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.0172 \n#>        AIC= 167.0172 \n#>        BIC= 181.1068 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.3931 \n#>        AIC= 167.3931 \n#>        BIC= 181.4827\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter      Estimate   SE     CV(%) p-value\n#>  y_min           2.73426 0.05123   1.87 -      \n#>  y_max           4.24654 0.05062   1.19 -      \n#>  rate            0.01127 0.00223  19.83 -      \n#>  beta_age(rate) -0.00391 0.00403 103.16 0.166  \n#>  a.              0.25548 0.01297   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0715   0.0212  29.7 \n#>  omega2.y_max 0.0633   0.0208  32.8 \n#>  omega2.rate  0.0403   0.0496 123.3 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 150.7797 \n#>        AIC= 166.7797 \n#>        BIC= 180.8693 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.0107 \n#>        AIC= 167.0107 \n#>        BIC= 181.1003\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min           2.73e+00 0.051327   1.88 -      \n#>  y_max           4.22e+00 0.119334   2.83 -      \n#>  beta_age(y_max) 7.11e-05 0.000582 818.20 0.451  \n#>  rate            9.17e-03 0.000782   8.53 -      \n#>  a.              2.56e-01 0.012995   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.07065  0.02118  30.0 \n#>  omega2.y_max 0.00356  0.00116  32.6 \n#>  omega2.rate  0.04189  0.05034 120.2 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.6332 \n#>        AIC= 167.6332 \n#>        BIC= 181.7228 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.9172 \n#>        AIC= 167.9172 \n#>        BIC= 182.0068\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate    SE      CV(%) p-value\n#>  y_min            2.745738 0.119586   4.36 -      \n#>  beta_age(y_min) -0.000231 0.000896 388.46 0.398  \n#>  y_max            4.242183 0.050428   1.19 -      \n#>  rate             0.009373 0.000796   8.50 -      \n#>  a.               0.257262 0.013044   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.00925  0.0028  30.2 \n#>  omega2.y_max 0.06235  0.0206  33.1 \n#>  omega2.rate  0.04047  0.0494 122.1 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.0172 \n#>        AIC= 167.0172 \n#>        BIC= 181.1068 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.3931 \n#>        AIC= 167.3931 \n#>        BIC= 181.4827\n```\n:::\n\n\n\n### BMI \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define models with main effects\nsaemix_data_nlme_age <- saemixData(\n  name.data = tb_after_7,\n  name.group = \"id\",\n  name.predictors = \"time\",\n  name.response = \"abelisa\",\n  name.covariates = \"bmi\",\n  units = list(x = \"Days\", y = \"EU/ml\")\n)\n#> Using the object called tb_after_7 in this R session as the data.\n#> [1] \"bmi\"\n#> \n#> \n#> The following SaemixData object was successfully created:\n#> \n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     Predictor: time (Days) \n#>     covariates: bmi (-)\n\ncovariate_model_matrix_rate <- matrix(\n  data = c(0, 0, 1),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"bmi\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_rate <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.0, 0.01), # covariate effect on rate only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_rate <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_rate,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_rate,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> bmi     0     0    1\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6   4.9 0.05\n#> Cov.CondInit   0.0   0.0 0.01\n\nsaemix_fit_nlme_age_rate <- saemix(\n  saemix_model_nlme_rate,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter      Estimate   SE    CV(%) p-value\n#>  y_min           2.7327  0.0509   1.86 -      \n#>  y_max           4.2422  0.0502   1.18 -      \n#>  rate            0.0146  0.0117  79.96 -      \n#>  beta_bmi(rate) -0.0227  0.0406 178.67 0.288  \n#>  a.              0.2568  0.0130   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0694   0.0208  30.0 \n#>  omega2.y_max 0.0616   0.0204  33.1 \n#>  omega2.rate  0.0355   0.0488 137.4 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.0655 \n#>        AIC= 167.0655 \n#>        BIC= 181.1551 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.2937 \n#>        AIC= 167.2937 \n#>        BIC= 181.3833\n\n#----\n\ncovariate_model_matrix_y_max <- matrix(\n  data = c(0, 1, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"bmi\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_max <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.01, 0.0), # covariate effect on y_max only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_max <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_max,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_max,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> bmi     0     1    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6  4.90 0.05\n#> Cov.CondInit   0.0  0.01 0.00\n\nsaemix_fit_nlme_age_y_max <- saemix(\n  saemix_model_nlme_y_max,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min           2.73159  0.050906   1.86 -      \n#>  y_max           3.79836  0.458175  12.06 -      \n#>  beta_bmi(y_max) 0.02277  0.023381 102.66 0.165  \n#>  rate            0.00942  0.000812   8.61 -      \n#>  a.              0.25594  0.013007   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0697   0.0210  30.1 \n#>  omega2.y_max 0.0615   0.0205  33.3 \n#>  omega2.rate  0.0478   0.0514 107.5 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.4091 \n#>        AIC= 167.4091 \n#>        BIC= 181.4987 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.6474 \n#>        AIC= 167.6474 \n#>        BIC= 181.737\n\n#----\n\ncovariate_model_matrix_y_min <- matrix(\n  data = c(1, 0, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"bmi\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_min <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.01, 0.0, 0.0), # covariate effect on y_min only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_min <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_min,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_min,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> bmi     1     0    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit  1.60   4.9 0.05\n#> Cov.CondInit  0.01   0.0 0.00\n\nsaemix_fit_nlme_age_y_min <- saemix(\n  saemix_model_nlme_y_min,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min            2.78592 0.464041  16.66 -      \n#>  beta_bmi(y_min) -0.00288 0.023678 823.47 0.452  \n#>  y_max            4.24304 0.049591   1.17 -      \n#>  rate             0.00939 0.000817   8.70 -      \n#>  a.               0.25662 0.013047   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0697   0.0211  30.2 \n#>  omega2.y_max 0.0588   0.0200  34.0 \n#>  omega2.rate  0.0525   0.0525 100.0 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 152.5203 \n#>        AIC= 168.5203 \n#>        BIC= 182.6099 \n#> Likelihood computed by importance sampling\n#>       -2LL= 152.7728 \n#>        AIC= 168.7728 \n#>        BIC= 182.8624\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter      Estimate   SE    CV(%) p-value\n#>  y_min           2.7327  0.0509   1.86 -      \n#>  y_max           4.2422  0.0502   1.18 -      \n#>  rate            0.0146  0.0117  79.96 -      \n#>  beta_bmi(rate) -0.0227  0.0406 178.67 0.288  \n#>  a.              0.2568  0.0130   5.07 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0694   0.0208  30.0 \n#>  omega2.y_max 0.0616   0.0204  33.1 \n#>  omega2.rate  0.0355   0.0488 137.4 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.0655 \n#>        AIC= 167.0655 \n#>        BIC= 181.1551 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.2937 \n#>        AIC= 167.2937 \n#>        BIC= 181.3833\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min           2.73159  0.050906   1.86 -      \n#>  y_max           3.79836  0.458175  12.06 -      \n#>  beta_bmi(y_max) 0.02277  0.023381 102.66 0.165  \n#>  rate            0.00942  0.000812   8.61 -      \n#>  a.              0.25594  0.013007   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0697   0.0210  30.1 \n#>  omega2.y_max 0.0615   0.0205  33.3 \n#>  omega2.rate  0.0478   0.0514 107.5 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.4091 \n#>        AIC= 167.4091 \n#>        BIC= 181.4987 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.6474 \n#>        AIC= 167.6474 \n#>        BIC= 181.737\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min            2.78592 0.464041  16.66 -      \n#>  beta_bmi(y_min) -0.00288 0.023678 823.47 0.452  \n#>  y_max            4.24304 0.049591   1.17 -      \n#>  rate             0.00939 0.000817   8.70 -      \n#>  a.               0.25662 0.013047   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0697   0.0211  30.2 \n#>  omega2.y_max 0.0588   0.0200  34.0 \n#>  omega2.rate  0.0525   0.0525 100.0 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 152.5203 \n#>        AIC= 168.5203 \n#>        BIC= 182.6099 \n#> Likelihood computed by importance sampling\n#>       -2LL= 152.7728 \n#>        AIC= 168.7728 \n#>        BIC= 182.8624\n```\n:::\n\n\n\n### Sex \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define models with main effects\nsaemix_data_nlme_age <- saemixData(\n  name.data = tb_after_7,\n  name.group = \"id\",\n  name.predictors = \"time\",\n  name.response = \"abelisa\",\n  name.covariates = \"sex\",\n  units = list(x = \"Days\", y = \"EU/ml\")\n)\n#> Using the object called tb_after_7 in this R session as the data.\n#> [1] \"sex\"\n#> \n#> \n#> The following SaemixData object was successfully created:\n#> \n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     Predictor: time (Days) \n#>     covariates: sex (-) \n#>       reference class for covariate sex :  Female\n\ncovariate_model_matrix_rate <- matrix(\n  data = c(0, 0, 1),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"sex\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_rate <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.0, 0.01), # covariate effect on rate only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_rate <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_rate,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_rate,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> sex     0     0    1\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6   4.9 0.05\n#> Cov.CondInit   0.0   0.0 0.01\n\nsaemix_fit_nlme_age_rate <- saemix(\n  saemix_model_nlme_rate,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter      Estimate   SE      CV(%) p-value \n#>  y_min          2.75181  0.050450  1.83  -       \n#>  y_max          4.27740  0.045686  1.07  -       \n#>  rate           0.00822  0.000851 10.35  -       \n#>  beta_sex(rate) 0.51135  0.144280 28.22  0.000197\n#>  a.             0.25893  0.013037  5.03  -       \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0697   0.0206  29.6 \n#>  omega2.y_max 0.0360   0.0156  43.4 \n#>  omega2.rate  0.0354   0.0472 133.2 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 142.1439 \n#>        AIC= 158.1439 \n#>        BIC= 172.2335 \n#> Likelihood computed by importance sampling\n#>       -2LL= 142.3091 \n#>        AIC= 158.3091 \n#>        BIC= 172.3987\n\n#----\n\ncovariate_model_matrix_y_max <- matrix(\n  data = c(0, 1, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"sex\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_max <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.01, 0.0), # covariate effect on y_max only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_max <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_max,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_max,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> sex     0     1    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6  4.90 0.05\n#> Cov.CondInit   0.0  0.01 0.00\n\nsaemix_fit_nlme_age_y_max <- saemix(\n  saemix_model_nlme_y_max,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE     CV(%) p-value \n#>  y_min            2.73419 0.05047  1.85  -       \n#>  y_max            4.50272 0.05044  1.12  -       \n#>  beta_sex(y_max) -0.48657 0.06384 13.12  1.25e-14\n#>  rate             0.00952 0.00079  8.30  -       \n#>  a.               0.25363 0.01268  5.00  -       \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.0692   0.02051  29.6 \n#>  omega2.y_max 0.0124   0.00994  80.2 \n#>  omega2.rate  0.0367   0.04129 112.4 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 110.892 \n#>        AIC= 126.892 \n#>        BIC= 140.9816 \n#> Likelihood computed by importance sampling\n#>       -2LL= 111.0156 \n#>        AIC= 127.0156 \n#>        BIC= 141.1052\n\n#----\n\ncovariate_model_matrix_y_min <- matrix(\n  data = c(1, 0, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"sex\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_min <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.01, 0.0, 0.0), # covariate effect on y_min only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_min <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_min,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_min,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>     y_min y_max rate\n#> sex     1     0    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit  1.60   4.9 0.05\n#> Cov.CondInit  0.01   0.0 0.00\n\nsaemix_fit_nlme_age_y_min <- saemix(\n  saemix_model_nlme_y_min,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min           2.70967  0.071226   2.63 -      \n#>  beta_sex(y_min) 0.04365  0.094484 216.47 0.322  \n#>  y_max           4.24258  0.050451   1.19 -      \n#>  rate            0.00939  0.000801   8.53 -      \n#>  a.              0.25646  0.013016   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0695   0.0209  30   \n#>  omega2.y_max 0.0626   0.0206  33   \n#>  omega2.rate  0.0412   0.0499 121   \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.7131 \n#>        AIC= 167.7131 \n#>        BIC= 181.8027 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.9476 \n#>        AIC= 167.9476 \n#>        BIC= 182.0372\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter      Estimate   SE      CV(%) p-value \n#>  y_min          2.75181  0.050450  1.83  -       \n#>  y_max          4.27740  0.045686  1.07  -       \n#>  rate           0.00822  0.000851 10.35  -       \n#>  beta_sex(rate) 0.51135  0.144280 28.22  0.000197\n#>  a.             0.25893  0.013037  5.03  -       \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0697   0.0206  29.6 \n#>  omega2.y_max 0.0360   0.0156  43.4 \n#>  omega2.rate  0.0354   0.0472 133.2 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 142.1439 \n#>        AIC= 158.1439 \n#>        BIC= 172.2335 \n#> Likelihood computed by importance sampling\n#>       -2LL= 142.3091 \n#>        AIC= 158.3091 \n#>        BIC= 172.3987\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE     CV(%) p-value \n#>  y_min            2.73419 0.05047  1.85  -       \n#>  y_max            4.50272 0.05044  1.12  -       \n#>  beta_sex(y_max) -0.48657 0.06384 13.12  1.25e-14\n#>  rate             0.00952 0.00079  8.30  -       \n#>  a.               0.25363 0.01268  5.00  -       \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE     CV(%)\n#>  omega2.y_min 0.0692   0.02051  29.6 \n#>  omega2.y_max 0.0124   0.00994  80.2 \n#>  omega2.rate  0.0367   0.04129 112.4 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 110.892 \n#>        AIC= 126.892 \n#>        BIC= 140.9816 \n#> Likelihood computed by importance sampling\n#>       -2LL= 111.0156 \n#>        AIC= 127.0156 \n#>        BIC= 141.1052\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter       Estimate   SE      CV(%) p-value\n#>  y_min           2.70967  0.071226   2.63 -      \n#>  beta_sex(y_min) 0.04365  0.094484 216.47 0.322  \n#>  y_max           4.24258  0.050451   1.19 -      \n#>  rate            0.00939  0.000801   8.53 -      \n#>  a.              0.25646  0.013016   5.08 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0695   0.0209  30   \n#>  omega2.y_max 0.0626   0.0206  33   \n#>  omega2.rate  0.0412   0.0499 121   \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.7131 \n#>        AIC= 167.7131 \n#>        BIC= 181.8027 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.9476 \n#>        AIC= 167.9476 \n#>        BIC= 182.0372\n```\n:::\n\n\n\n\n### Country \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define models with main effects\nsaemix_data_nlme_age <- saemixData(\n  name.data = tb_after_7,\n  name.group = \"id\",\n  name.predictors = \"time\",\n  name.response = \"abelisa\",\n  name.covariates = \"country\",\n  units = list(x = \"Days\", y = \"EU/ml\")\n)\n#> Using the object called tb_after_7 in this R session as the data.\n#> [1] \"country\"\n#> \n#> \n#> The following SaemixData object was successfully created:\n#> \n#> Object of class SaemixData\n#>     longitudinal data for use with the SAEM algorithm\n#> Dataset tb_after_7 \n#>     Structured data: abelisa ~ time | id \n#>     Predictor: time (Days) \n#>     covariates: country (-) \n#>       reference class for covariate country :  West Africa\n\ncovariate_model_matrix_rate <- matrix(\n  data = c(0, 0, 1),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"country\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_rate <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.0, 0.01), # covariate effect on rate only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_rate <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_rate,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_rate,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>         y_min y_max rate\n#> country     0     0    1\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6   4.9 0.05\n#> Cov.CondInit   0.0   0.0 0.01\n\nsaemix_fit_nlme_age_rate <- saemix(\n  saemix_model_nlme_rate,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter          Estimate   SE     CV(%) p-value\n#>  y_min               2.7168  0.05020   1.85 -      \n#>  y_max               4.2287  0.05025   1.19 -      \n#>  rate                0.0095  0.00106  11.19 -      \n#>  beta_country(rate) -0.0713  0.08766 122.89 0.208  \n#>  a.                  0.2585  0.01309   5.06 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0629   0.0197  31.4 \n#>  omega2.y_max 0.0626   0.0205  32.7 \n#>  omega2.rate  0.0362   0.0489 134.9 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.3293 \n#>        AIC= 167.3293 \n#>        BIC= 181.4189 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.4219 \n#>        AIC= 167.4219 \n#>        BIC= 181.5115\n\n#----\n\ncovariate_model_matrix_y_max <- matrix(\n  data = c(0, 1, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"country\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_max <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.0, 0.01, 0.0), # covariate effect on y_max only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_max <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_max,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_max,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>         y_min y_max rate\n#> country     0     1    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit   1.6  4.90 0.05\n#> Cov.CondInit   0.0  0.01 0.00\n\nsaemix_fit_nlme_age_y_max <- saemix(\n  saemix_model_nlme_y_max,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter           Estimate   SE      CV(%) p-value\n#>  y_min                2.72642 0.051349   1.88 -      \n#>  y_max                4.29402 0.076175   1.77 -      \n#>  beta_country(y_max) -0.04994 0.053854 107.84 0.177  \n#>  rate                 0.00932 0.000806   8.65 -      \n#>  a.                   0.25560 0.012998   5.09 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0714   0.0214  30.0 \n#>  omega2.y_max 0.0605   0.0202  33.5 \n#>  omega2.rate  0.0517   0.0519 100.2 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.7716 \n#>        AIC= 167.7716 \n#>        BIC= 181.8612 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.9732 \n#>        AIC= 167.9732 \n#>        BIC= 182.0628\n\n#----\n\ncovariate_model_matrix_y_min <- matrix(\n  data = c(1, 0, 0),\n  nrow = 1,\n  ncol = 3,\n  dimnames = list(\"country\", c(\"y_min\", \"y_max\", \"rate\"))\n)\n\npsi0_matrix_y_min <- matrix(\n  c(1.6, 4.9, 0.05,  # fixed effects: y_min, y_max, rate\n    0.01, 0.0, 0.0), # covariate effect on y_min only\n  nrow = 2,\n  byrow = TRUE,\n  dimnames = list(NULL, c(\"y_min\", \"y_max\", \"rate\"))\n)\n\nsaemix_model_nlme_y_min <- saemixModel(\n  model = function_approx,\n  description = \"Antibody decay model with age covariate\",\n  psi0 = psi0_matrix_y_min,\n  transform.par = c(0, 0, 1),           # log-transform rate\n  covariance.model = diag(1, 3),\n  covariate.model = covariate_model_matrix_y_min,\n  error.model = \"constant\"\n)\n#> \n#> \n#> The following SaemixModel object was successfully created:\n#> \n#> Nonlinear mixed-effects model\n#>   Model function:  Antibody decay model with age covariate\n#> function(psi, id, xidep) {\n#>   time <- xidep[, 1]\n#>   y_min <- psi[id, 1]\n#>   y_max <- psi[id, 2]\n#>   rate  <- psi[id, 3]\n#>   fpred <- y_min + (y_max - y_min) * exp(-rate * time)\n#>   return(fpred)\n#> }\n#> <bytecode: 0x11b038130>\n#>   Nb of parameters: 3 \n#>       parameter names:  y_min y_max rate \n#>       distribution:\n#>      Parameter Distribution Estimated\n#> [1,] y_min     normal       Estimated\n#> [2,] y_max     normal       Estimated\n#> [3,] rate      log-normal   Estimated\n#>   Variance-covariance matrix:\n#>       y_min y_max rate\n#> y_min     1     0    0\n#> y_max     0     1    0\n#> rate      0     0    1\n#>   Error model: constant , initial values: a.=1 \n#>   Covariate model:\n#>         y_min y_max rate\n#> country     1     0    0\n#>     Initial values\n#>              y_min y_max rate\n#> Pop.CondInit  1.60   4.9 0.05\n#> Cov.CondInit  0.01   0.0 0.00\n\nsaemix_fit_nlme_age_y_min <- saemix(\n  saemix_model_nlme_y_min,\n  saemix_data_nlme_age,\n  saemix_options_nlme\n)\n#> Plotting the data\n#> Plotting convergence plots\n#> Plotting the likelihood\n#> Plotting observations versus predictions\n#> Plotting individual fits\n\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter           Estimate   SE      CV(%) p-value \n#>  y_min               2.42427  0.054376  2.24  -       \n#>  beta_country(y_min) 0.29507  0.036495 12.37  3.33e-16\n#>  y_max               4.25161  0.049480  1.16  -       \n#>  rate                0.00961  0.000873  9.09  -       \n#>  a.                  0.25376  0.012781  5.04  -       \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0142   0.0094 66.1  \n#>  omega2.y_max 0.0586   0.0201 34.4  \n#>  omega2.rate  0.0852   0.0517 60.7  \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 112.6378 \n#>        AIC= 128.6378 \n#>        BIC= 142.7274 \n#> Likelihood computed by importance sampling\n#>       -2LL= 112.9279 \n#>        AIC= 128.9279 \n#>        BIC= 143.0175\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_rate@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter          Estimate   SE     CV(%) p-value\n#>  y_min               2.7168  0.05020   1.85 -      \n#>  y_max               4.2287  0.05025   1.19 -      \n#>  rate                0.0095  0.00106  11.19 -      \n#>  beta_country(rate) -0.0713  0.08766 122.89 0.208  \n#>  a.                  0.2585  0.01309   5.06 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0629   0.0197  31.4 \n#>  omega2.y_max 0.0626   0.0205  32.7 \n#>  omega2.rate  0.0362   0.0489 134.9 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.3293 \n#>        AIC= 167.3293 \n#>        BIC= 181.4189 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.4219 \n#>        AIC= 167.4219 \n#>        BIC= 181.5115\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_max@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter           Estimate   SE      CV(%) p-value\n#>  y_min                2.72642 0.051349   1.88 -      \n#>  y_max                4.29402 0.076175   1.77 -      \n#>  beta_country(y_max) -0.04994 0.053854 107.84 0.177  \n#>  rate                 0.00932 0.000806   8.65 -      \n#>  a.                   0.25560 0.012998   5.09 -      \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0714   0.0214  30.0 \n#>  omega2.y_max 0.0605   0.0202  33.5 \n#>  omega2.rate  0.0517   0.0519 100.2 \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 151.7716 \n#>        AIC= 167.7716 \n#>        BIC= 181.8612 \n#> Likelihood computed by importance sampling\n#>       -2LL= 151.9732 \n#>        AIC= 167.9732 \n#>        BIC= 182.0628\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaemix_fit_nlme_age_y_min@results\n#> Fixed effects\n#> Warning in methods::show(x): NAs introduced by coercion\n#>  Parameter           Estimate   SE      CV(%) p-value \n#>  y_min               2.42427  0.054376  2.24  -       \n#>  beta_country(y_min) 0.29507  0.036495 12.37  3.33e-16\n#>  y_max               4.25161  0.049480  1.16  -       \n#>  rate                0.00961  0.000873  9.09  -       \n#>  a.                  0.25376  0.012781  5.04  -       \n#> \n#> Variance of random effects\n#>  Parameter    Estimate   SE    CV(%)\n#>  omega2.y_min 0.0142   0.0094 66.1  \n#>  omega2.y_max 0.0586   0.0201 34.4  \n#>  omega2.rate  0.0852   0.0517 60.7  \n#> \n#> Statistical criteria\n#> Likelihood computed by linearisation\n#>       -2LL= 112.6378 \n#>        AIC= 128.6378 \n#>        BIC= 142.7274 \n#> Likelihood computed by importance sampling\n#>       -2LL= 112.9279 \n#>        AIC= 128.9279 \n#>        BIC= 143.0175\n```\n:::\n",
    "supporting": [
      "nlme-covariates_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}