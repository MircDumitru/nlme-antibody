<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Non-linear mixed effects models - 1&nbsp; NLME models for antibody concentration decay</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ebola.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">NLME models for antibody concentration decay</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Non-linear mixed effects models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ebola.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">NLME models for antibody concentration decay</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1.1</span> Introduction</a>
  <ul class="collapse">
<li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites"><span class="header-section-number">1.1.1</span> Prerequisites</a></li>
  </ul>
</li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">1.2</span> Exploratory data analysis</a></li>
  <li>
<a href="#the-factor-variables" id="toc-the-factor-variables" class="nav-link" data-scroll-target="#the-factor-variables"><span class="header-section-number">1.3</span> The factor variables</a>
  <ul class="collapse">
<li><a href="#the-id-variable" id="toc-the-id-variable" class="nav-link" data-scroll-target="#the-id-variable"><span class="header-section-number">1.3.1</span> The <code>id</code> variable</a></li>
  <li><a href="#the-sex-variable" id="toc-the-sex-variable" class="nav-link" data-scroll-target="#the-sex-variable"><span class="header-section-number">1.3.2</span> The <code>sex</code> variable</a></li>
  <li><a href="#the-country-variable" id="toc-the-country-variable" class="nav-link" data-scroll-target="#the-country-variable"><span class="header-section-number">1.3.3</span> The <code>country</code> variable</a></li>
  </ul>
</li>
  <li>
<a href="#the-numerical-variables" id="toc-the-numerical-variables" class="nav-link" data-scroll-target="#the-numerical-variables"><span class="header-section-number">1.4</span> The numerical variables</a>
  <ul class="collapse">
<li><a href="#the-time-variable" id="toc-the-time-variable" class="nav-link" data-scroll-target="#the-time-variable"><span class="header-section-number">1.4.1</span> The <code>time</code> variable</a></li>
  <li><a href="#the-age-variable" id="toc-the-age-variable" class="nav-link" data-scroll-target="#the-age-variable"><span class="header-section-number">1.4.2</span> The <code>age</code> variable</a></li>
  <li><a href="#the-bmi-variable" id="toc-the-bmi-variable" class="nav-link" data-scroll-target="#the-bmi-variable"><span class="header-section-number">1.4.3</span> The <code>bmi</code> variable</a></li>
  <li><a href="#the-abelisa-variable" id="toc-the-abelisa-variable" class="nav-link" data-scroll-target="#the-abelisa-variable"><span class="header-section-number">1.4.4</span> The <code>abelisa</code> variable</a></li>
  </ul>
</li>
  <li><a href="#an-approximation-function" id="toc-an-approximation-function" class="nav-link" data-scroll-target="#an-approximation-function"><span class="header-section-number">1.5</span> An approximation function</a></li>
  <li>
<a href="#non-linear-nl-model" id="toc-non-linear-nl-model" class="nav-link" data-scroll-target="#non-linear-nl-model"><span class="header-section-number">1.6</span> Non-linear (NL) model</a>
  <ul class="collapse">
<li><a href="#one-subject" id="toc-one-subject" class="nav-link" data-scroll-target="#one-subject"><span class="header-section-number">1.6.1</span> One subject</a></li>
  <li><a href="#multiple-subjects" id="toc-multiple-subjects" class="nav-link" data-scroll-target="#multiple-subjects"><span class="header-section-number">1.6.2</span> Multiple subjects</a></li>
  <li><a href="#multiple-models-fitted-on-multiple-subjects" id="toc-multiple-models-fitted-on-multiple-subjects" class="nav-link" data-scroll-target="#multiple-models-fitted-on-multiple-subjects"><span class="header-section-number">1.6.3</span> Multiple models fitted on multiple subjects</a></li>
  </ul>
</li>
  <li><a href="#non-linear-mixed-effects-nlme-model---no-covariates" id="toc-non-linear-mixed-effects-nlme-model---no-covariates" class="nav-link" data-scroll-target="#non-linear-mixed-effects-nlme-model---no-covariates"><span class="header-section-number">1.7</span> Non-linear mixed effects (NLME) model - no covariates</a></li>
  <li><a href="#non-linear-mixed-effects-nlme-model---covariates" id="toc-non-linear-mixed-effects-nlme-model---covariates" class="nav-link" data-scroll-target="#non-linear-mixed-effects-nlme-model---covariates"><span class="header-section-number">1.8</span> Non-linear mixed effects (NLME) model - covariates</a></li>
  <li><a href="#the-model-proposed-by-pasin2019" id="toc-the-model-proposed-by-pasin2019" class="nav-link" data-scroll-target="#the-model-proposed-by-pasin2019"><span class="header-section-number">1.9</span> The model proposed by <span class="citation" data-cites="pasin2019">(Pasin et al. 2019)</span></a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-nlme-ab" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">NLME models for antibody concentration decay</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">1.1</span> Introduction</h2>
<section id="prerequisites" class="level3" data-number="1.1.1"><h3 data-number="1.1.1" class="anchored" data-anchor-id="prerequisites">
<span class="header-section-number">1.1.1</span> Prerequisites</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>  <span class="co"># tidyverse </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>       <span class="co"># non-linear mixed effect models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">saemix</span><span class="op">)</span>     <span class="co"># nlme package for saemix objects;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="exploratory-data-analysis" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="exploratory-data-analysis">
<span class="header-section-number">1.2</span> Exploratory data analysis</h2>
<p>Reading the csv file and look at its head:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># read the csv file</span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/data_ebola_ab.csv"</span><span class="op">)</span></span>
<span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccccccc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in attr(x, "align"): 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated")</span></span>
<span><span class="co">#&gt; Warning in attr(x, "format"): 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">time</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">bmi</th>
<th style="text-align: center;">country</th>
<th style="text-align: center;">Abelisa</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">1.785124</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">4.434470</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">4.124822</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">4.050954</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">3.382073</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">2.935390</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Check the data types (and transform “character” into “factors” if any) and check for missing values.</p>
<p><a href="#tbl-var-types" class="quarto-xref">Table&nbsp;<span>1.1</span></a> shows the corresponding data types for the variables in the data set. Three variables (<code>ID</code>, <code>sex</code>, <code>country</code>) are categorical variables and will be re-coded as factors.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># checking the var types</span></span>
<span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">typeof</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccccccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-var-types" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-var-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.1: The variable types in the data set
</figcaption><div aria-describedby="tbl-var-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">time</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">bmi</th>
<th style="text-align: center;">country</th>
<th style="text-align: center;">Abelisa</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">character</td>
<td style="text-align: center;">double</td>
<td style="text-align: center;">character</td>
<td style="text-align: center;">double</td>
<td style="text-align: center;">double</td>
<td style="text-align: center;">character</td>
<td style="text-align: center;">double</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-missing-vals" class="quarto-xref">Table&nbsp;<span>1.2</span></a> shows the number of missing values for each variable in the data set. There are no missing values.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># checking for possible missing vals</span></span>
<span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccccccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-missing-vals" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-missing-vals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.2: The number of missing values in each variable
</figcaption><div aria-describedby="tbl-missing-vals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">time</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">bmi</th>
<th style="text-align: center;">country</th>
<th style="text-align: center;">Abelisa</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Two pre-processing operations should be done:</p>
<ul>
<li>cleaning the names (not essential but for consistency we adhere to the tidy design principles),</li>
<li>transforming the “character” variables into “factors” (when important, the ordering of factors should be accounted for; here the <code>sex</code> and <code>country</code> variables are not ordered factors; the <code>ID</code> variable might be ordered for visualizations reasons if necessary).</li>
</ul>
<p>The following chunk is doing the pre-processing as mentioned above and checks the correctness of the pre-processing.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># clean the names</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># transform chr into factors</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="va">fct</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check the transformed tibble</span></span>
<span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 360</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ id      &lt;fct&gt; ID1, ID1, ID1, ID1, ID1, ID1, ID1, ID1, ID2, ID2, ID2, ID2, ID…</span></span>
<span><span class="co">#&gt; $ time    &lt;dbl&gt; 0, 7, 15, 30, 90, 180, 365, 730, 0, 7, 15, 30, 90, 180, 365, 7…</span></span>
<span><span class="co">#&gt; $ sex     &lt;fct&gt; Female, Female, Female, Female, Female, Female, Female, Female…</span></span>
<span><span class="co">#&gt; $ age     &lt;dbl&gt; 35.49993, 35.49993, 35.49993, 35.49993, 35.49993, 35.49993, 35…</span></span>
<span><span class="co">#&gt; $ bmi     &lt;dbl&gt; 20.69408, 20.69408, 20.69408, 20.69408, 20.69408, 20.69408, 20…</span></span>
<span><span class="co">#&gt; $ country &lt;fct&gt; West Africa, West Africa, West Africa, West Africa, West Afric…</span></span>
<span><span class="co">#&gt; $ abelisa &lt;dbl&gt; 1.785124, 4.434471, 4.124822, 4.050954, 3.382073, 2.935390, 2.…</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The tibbles now has factor variables &amp; tidy names. The next chunk is looking at the number of unique values in factor variables (i.e.&nbsp;the support of the categorical variables). <a href="#tbl-fcts-unique" class="quarto-xref">Table&nbsp;<span>1.3</span></a> shows the number of unique values in factor variables.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tb |&gt;</span></span>
<span><span class="co">#   summarise(across(where(is.factor), \(x) length(unique(x))))</span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">n_distinct</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-fcts-unique" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fcts-unique-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.3: The corresponding number of levels for the factor variables
</figcaption><div aria-describedby="tbl-fcts-unique-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">id</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">country</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">45</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>For the factor variables in the tibble:</p>
<ul>
<li>45 levels for <code>id</code> factor variable.</li>
<li>2 levels for <code>sex</code> factor variable.</li>
<li>3 levels for <code>country</code> factor variable.</li>
</ul>
<p>The next subsections are looking at the factor variables. The goal is to have an idea about possible inbalances between levels and to have some visual inspection of their distributions.</p>
</section><section id="the-factor-variables" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="the-factor-variables">
<span class="header-section-number">1.3</span> The factor variables</h2>
<section id="the-id-variable" class="level3" data-number="1.3.1"><h3 data-number="1.3.1" class="anchored" data-anchor-id="the-id-variable">
<span class="header-section-number">1.3.1</span> The <code>id</code> variable</h3>
<p>The following chunk is computing the counts and proportions of the <code>id</code>’s variable levels.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_id_levels_number</span> <span class="op">&lt;-</span> <span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">id</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    prop <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#tbl-id-levels-number" class="quarto-xref">Table&nbsp;<span>1.4</span></a> shows the head of the summarized data, showing the corresponding counts (representing the number of measurements/observations) for each level in the <code>id</code> variable and <a href="#fig-id-levels-number" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> shows a visualisation of the <code>id</code> variable level’s counts.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_id_levels_number</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-id-levels-number" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-id-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.4: The number of observations for each level corresponding to <code>id</code> variable
</figcaption><div aria-describedby="tbl-id-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">id</th>
<th style="text-align: center;">n</th>
<th style="text-align: center;">prop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.0222222</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID2</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.0222222</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID3</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.0222222</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.0222222</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID5</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.0222222</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID6</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.0222222</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_id_levels_number</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">id</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">id</span>, xend <span class="op">=</span> <span class="va">id</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Number of observations of the ID levels"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Each subject appears with 8 measurements in the data"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Subject's ID"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of observations"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-id-levels-number" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-id-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-id-levels-number-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-id-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: The number of observations for each level corresponding to <code>id</code> variable
</figcaption></figure>
</div>
</div>
</div>
<p>It seems that each <code>id</code> level has the same number of counts for each level, i.e.&nbsp;it seems that there are preciselsy <span class="math inline">8</span> observations for <em>every</em> subject in the data set. This can be checked by looking at the complete tibble given its small size but in general it can be checked by computing the number of distinct values in counts variable (<code>n</code>) in the summarized data. The following codes does exactly this:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_id_levels_number</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There is only one numerical value (8 in this case) corresponding to the ID counts for each level. Hence, it can be concluded that</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The number of observations (measurements) is the same across the subjects (8 observations), i.e.&nbsp;there are no missing or additional measurements for any subject in the data set.</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_obs_per_subject</span> <span class="op">&lt;-</span> <span class="va">tb_id_levels_number</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># n_obs_per_subject</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="the-sex-variable" class="level3" data-number="1.3.2"><h3 data-number="1.3.2" class="anchored" data-anchor-id="the-sex-variable">
<span class="header-section-number">1.3.2</span> The <code>sex</code> variable</h3>
<p>The following chunk is looking at the counts and proportion of the <code>sex</code>’s variable levels.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_sex_levels_number</span> <span class="op">&lt;-</span> <span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n_obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">sex</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    n_subjects <span class="op">=</span> <span class="va">n_obs</span> <span class="op">/</span> <span class="va">n_obs_per_subject</span>,</span>
<span>    prop <span class="op">=</span> <span class="va">n_subjects</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n_subjects</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#tbl-sex_levels_number" class="quarto-xref">Table&nbsp;<span>1.5</span></a> shows the number of subjects for each <code>sex</code>’s variable level and their corresponding proportion in the data set. <a href="#fig-sex_levels_number" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> shows a bar plot visualisation of the proportions.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_sex_levels_number</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sex_levels_number" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sex_levels_number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.5: The number of subjects for each sex level and their corresponding proportion in the data set.
</figcaption><div aria-describedby="tbl-sex_levels_number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">sex</th>
<th style="text-align: center;">n_obs</th>
<th style="text-align: center;">n_subjects</th>
<th style="text-align: center;">prop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Female</td>
<td style="text-align: center;">168</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0.4666667</td>
</tr>
<tr class="even">
<td style="text-align: center;">Male</td>
<td style="text-align: center;">192</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">0.5333333</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sex</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Proportion of the sex levels in the data"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Subject's sex"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Proportion"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-sex_levels_number" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sex_levels_number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-sex_levels_number-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sex_levels_number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: The proportion of the sex levels in the data.
</figcaption></figure>
</div>
</div>
</div>
<p>The counts and proportions for the levels corresponding to the <code>sex</code> variable are:</p>
<ul>
<li>“Female” level: 21 subjects, representing 0.47% of the data,</li>
<li>“Male” level: 24 subjects, representing 0.53% of the data.</li>
</ul>
<p>Hence, it can be concluded that</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The data is fairly balanced between the <code>sex</code>’s variable levels.</p>
</div>
</div>
</div>
</section><section id="the-country-variable" class="level3" data-number="1.3.3"><h3 data-number="1.3.3" class="anchored" data-anchor-id="the-country-variable">
<span class="header-section-number">1.3.3</span> The <code>country</code> variable</h3>
<p>The following chunk is looking at the counts and proportion of the <code>country</code>’s variable levels:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_country_levels_number</span> <span class="op">&lt;-</span> <span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n_obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">country</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    n_subjects <span class="op">=</span> <span class="va">n_obs</span> <span class="op">/</span> <span class="va">n_obs_per_subject</span>,</span>
<span>    prop <span class="op">=</span> <span class="va">n_subjects</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n_subjects</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#tbl-country-levels-number" class="quarto-xref">Table&nbsp;<span>1.6</span></a> shows the number of subjects for each <code>country</code>’s variable levels and their corresponding proportion in the data set. <a href="#fig-country-levels-number" class="quarto-xref">Figure&nbsp;<span>1.3</span></a> shows a bar plot visualisation of the proportions.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_country_levels_number</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-country-levels-number" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-country-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.6: The number of subjects for each country level and their corresponding proportion in the data set.
</figcaption><div aria-describedby="tbl-country-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">country</th>
<th style="text-align: center;">n_obs</th>
<th style="text-align: center;">n_subjects</th>
<th style="text-align: center;">prop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">0.3333333</td>
</tr>
<tr class="even">
<td style="text-align: center;">East Africa</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">0.2666667</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">0.4000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">country</span>,  y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Proportion of the country levels in the data"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Subjects's country"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Proportion"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-country-levels-number" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-country-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-country-levels-number-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-country-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: The proportion of the country levels in the data.
</figcaption></figure>
</div>
</div>
</div>
<p>The counts and proportions for the levels corresponding to the <code>country</code> variable are:</p>
<ul>
<li>“West Africa” level: 15 observations, representing 0.33% of the data,</li>
<li>“East Africa” level: 12 observations, representing 0.27% of the data,</li>
<li>“Europe” level: 18 observations, representing 0.4% of the data.</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The data is fairly balanced between the country levels.</p>
</div>
</div>
</div>
<p>The following chunk is looking at the proportion of the <code>sex</code>’s variable levels in each <code>country</code>’s variable levels.</p>
<p><a href="#tbl-country-sex-levels-number" class="quarto-xref">Table&nbsp;<span>1.7</span></a> shows the results &amp; <a href="#fig-country-sex-levels-number" class="quarto-xref">Figure&nbsp;<span>1.4</span></a> a bar plot visualisation.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n_subjects <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_obs_per_subject</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop_across_regions <span class="op">=</span> <span class="va">n_subjects</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n_subjects</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n_subjects</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n_subjects</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"cccccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-country-sex-levels-number" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-country-sex-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.7: The number of subjects for each sex - country pair corresponding levels and their corresponding proportion in the data set.
</figcaption><div aria-describedby="tbl-country-sex-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">country</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">n_subjects</th>
<th style="text-align: center;">prop_across_regions</th>
<th style="text-align: center;">prop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">0.6000000</td>
<td style="text-align: center;">0.2000000</td>
</tr>
<tr class="even">
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">Male</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.4000000</td>
<td style="text-align: center;">0.1333333</td>
</tr>
<tr class="odd">
<td style="text-align: center;">East Africa</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.4166667</td>
<td style="text-align: center;">0.1111111</td>
</tr>
<tr class="even">
<td style="text-align: center;">East Africa</td>
<td style="text-align: center;">Male</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">0.5833333</td>
<td style="text-align: center;">0.1555556</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">0.3888889</td>
<td style="text-align: center;">0.1555556</td>
</tr>
<tr class="even">
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">Male</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">0.6111111</td>
<td style="text-align: center;">0.2444444</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Proportion of sex for each region"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Patient's country"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Counts"</span>, </span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-country-sex-levels-number" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-country-sex-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-country-sex-levels-number-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-country-sex-levels-number-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: The proportion of the sex’s levels in country’s levels
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="the-numerical-variables" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="the-numerical-variables">
<span class="header-section-number">1.4</span> The numerical variables</h2>
<section id="the-time-variable" class="level3" data-number="1.4.1"><h3 data-number="1.4.1" class="anchored" data-anchor-id="the-time-variable">
<span class="header-section-number">1.4.1</span> The <code>time</code> variable</h3>
<p>The <code>id</code> variable analysis showed that for each subject (i.e.&nbsp;for each level of the <code>id</code> variable) exactly 8 measurements – taken at different times – are available. For the time variable, we check if the corresponding measurement times for each subject are the same (i.e.&nbsp;if for each subject in the data set the 8 measurements are taken at the same time instances). Because of the small size of the data set, we can get and idea if this is true by looking at the plot of measurement times for each ID, <a href="#fig-time-measurements" class="quarto-xref">Figure&nbsp;<span>1.5</span></a>. (Plot done using log(times) for a better visualization).</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">id</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Measurment times"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Patient's ID"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Log Time (days)"</span>, </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">7</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-time-measurements" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-time-measurements-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-time-measurements-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-measurements-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: The times of measurements for each subject in the data set.
</figcaption></figure>
</div>
</div>
</div>
<p>This can be checked rigorously via <code>pivot_wider</code>, pivoting the measurement times wider and checking if the value is unique in each time column. The next chunk is doing this.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># pivot the tibble wider and get the time measurements </span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">time</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"t_"</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">time</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"t_"</span><span class="op">)</span>, <span class="va">n_distinct</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccccccc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in attr(x, "align"): 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated")</span></span>
<span><span class="co">#&gt; Warning in attr(x, "format"): 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">t_0</th>
<th style="text-align: center;">t_7</th>
<th style="text-align: center;">t_15</th>
<th style="text-align: center;">t_30</th>
<th style="text-align: center;">t_90</th>
<th style="text-align: center;">t_180</th>
<th style="text-align: center;">t_365</th>
<th style="text-align: center;">t_730</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr></tbody>
</table>
</div>
</div>
<p>Hence, it can be concluded that</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The corresponding measurement times for each subject are taken the same time instances.</p>
</div>
</div>
</div>
<p>For all subjects in the data set, the measurements are taken at 0, 7, 15, 30, 90, 180, 365, 730 days.</p>
</section><section id="the-age-variable" class="level3" data-number="1.4.2"><h3 data-number="1.4.2" class="anchored" data-anchor-id="the-age-variable">
<span class="header-section-number">1.4.2</span> The <code>age</code> variable</h3>
<p>The following chunk is computing the density of <code>age</code> variable, showed in <a href="#fig-age-density" class="quarto-xref">Figure&nbsp;<span>1.6</span></a>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, fill <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age density"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-age-density" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-age-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-age-density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-age-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.6: The density of <code>age</code> variable.
</figcaption></figure>
</div>
</div>
</div>
<p>The <code>age</code> variable seems to contain negative values. The following chunk filters the tibble for negative age values, showed in <a href="#tbl-age-negative" class="quarto-xref">Table&nbsp;<span>1.8</span></a></p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_negative_age</span> <span class="op">&lt;-</span> <span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_negative_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"cc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-age-negative" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-negative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.8: The subjects correponding ID’s values for negative age values
</figcaption><div aria-describedby="tbl-age-negative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">id</th>
<th style="text-align: center;">age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ID27</td>
<td style="text-align: center;">-3.191009</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID33</td>
<td style="text-align: center;">-12.318307</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>There are two subjects with corresponding negative ages:</p>
<ul>
<li><p>subject ID27 which has the recorded corresponding age -3.19,</p></li>
<li><p>subject ID33 which has the recorded corresponding age -12.32.</p></li>
</ul>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The subjects appearing with negative age in the data are dropped.</p>
</div>
</div>
</div>
<p>The following chunks drops the subjects with corresponds negative age.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">&lt;-</span> <span class="va">tb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The conditional distributions of the <code>age</code> variable given the <code>sex</code> variable’s levels are fairly close to each other, <a href="#fig-age-cond-density" class="quarto-xref">Figure&nbsp;<span>1.7</span></a>. This is not the case for the conditional distributions of the <code>age</code> variable given the <code>country</code> variable’s levels: the age distribution for subjects from “West Africa” is significant different from the age distribution for subjects from “East Africa” and “Europe”. (This is not very significant though, accounting for the small number of subjects, <a href="#tbl-country-levels-number" class="quarto-xref">Table&nbsp;<span>1.6</span></a>.)</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age densities for sex levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age (year)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age densities for region levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-age-cond-density" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-age-cond-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-age-cond-density" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-age-cond-density-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-age-cond-density-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-age-cond-density-1.png" id="fig-age-cond-density-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-age-cond-density" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-age-cond-density-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-age-cond-density" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-age-cond-density-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-age-cond-density-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-age-cond-density-2.png" id="fig-age-cond-density-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-age-cond-density" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-age-cond-density-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-age-cond-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.7: The conditional distribution of <code>age</code> given <code>sex</code> and <code>country</code> variables.
</figcaption></figure>
</div>
<p>In this case, looking at the median, IQR and range is more sensible. <a href="#tbl-age-sex-median" class="quarto-xref">Table&nbsp;<span>1.9</span></a> and <a href="#tbl-age-country-median" class="quarto-xref">Table&nbsp;<span>1.10</span></a> are showing the min, median, IQR and max for the <code>age</code> variable conditional on <code>sex</code> and <code>country</code> levels, respectively. The corresponding boxplots are showed in <a href="#fig-age-sex-country-boxplot" class="quarto-xref">Figure&nbsp;<span>1.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    IQR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, </span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">sex</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-age-sex-median" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-sex-median-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.9: The min, median, IQR and max for the <code>age</code> variable conditional on <code>sex</code> variable’s levels.
</figcaption><div aria-describedby="tbl-age-sex-median-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">sex</th>
<th style="text-align: center;">min</th>
<th style="text-align: center;">median</th>
<th style="text-align: center;">IQR</th>
<th style="text-align: center;">max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Female</td>
<td style="text-align: center;">16.95602</td>
<td style="text-align: center;">47.08783</td>
<td style="text-align: center;">23.23231</td>
<td style="text-align: center;">79.14763</td>
</tr>
<tr class="even">
<td style="text-align: center;">Male</td>
<td style="text-align: center;">2.96366</td>
<td style="text-align: center;">44.15401</td>
<td style="text-align: center;">30.09295</td>
<td style="text-align: center;">80.64180</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,    </span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    IQR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, </span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">country</span></span>
<span>  <span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-age-country-median" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-country-median-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.10: The min, median, IQR and max for the <code>age</code> variable conditional on <code>country</code> variable’s levels.
</figcaption><div aria-describedby="tbl-age-country-median-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">country</th>
<th style="text-align: center;">min</th>
<th style="text-align: center;">median</th>
<th style="text-align: center;">IQR</th>
<th style="text-align: center;">max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">24.11422</td>
<td style="text-align: center;">39.29298</td>
<td style="text-align: center;">21.17336</td>
<td style="text-align: center;">80.64180</td>
</tr>
<tr class="even">
<td style="text-align: center;">East Africa</td>
<td style="text-align: center;">2.96366</td>
<td style="text-align: center;">50.63353</td>
<td style="text-align: center;">37.34947</td>
<td style="text-align: center;">68.56830</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Europe</td>
<td style="text-align: center;">16.95602</td>
<td style="text-align: center;">48.08937</td>
<td style="text-align: center;">32.51637</td>
<td style="text-align: center;">79.14763</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>, x <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age for sex levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Age (years)"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>, x <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age for region levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Age (years)"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-age-sex-country-boxplot" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-age-sex-country-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-age-sex-country-boxplot" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-age-sex-country-boxplot-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-age-sex-country-boxplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-age-sex-country-boxplot-1.png" id="fig-age-sex-country-boxplot-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-age-sex-country-boxplot" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-age-sex-country-boxplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-age-sex-country-boxplot" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-age-sex-country-boxplot-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-age-sex-country-boxplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-age-sex-country-boxplot-2.png" id="fig-age-sex-country-boxplot-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-age-sex-country-boxplot" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-age-sex-country-boxplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-age-sex-country-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.8: The boxplot of <code>age</code> variable given <code>sex</code> and <code>country</code> variables.
</figcaption></figure>
</div>
<p>Another thing that should be checked about <code>age</code> variable is the following: it seems the variable rather indicates the subject’s age at the beginning of the experiment and it <em>does not</em> increment during the experiment, i.e.&nbsp;it does not account for the time passed between measurements. This can be checked by looking at the distinct values of <code>id</code> and <code>age</code> in the data set:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_obs_per_subject</span> <span class="op">==</span> <span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Hence, it can be concluded that</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <code>age</code> variable represents the subject’s age at the beginning of the experiment and it is not accounting for the time between measurements.</p>
</div>
</div>
</div>
<p>Another variable <code>age_updated</code> that represents the subject’s age at the time of each measurement is added to the tibble in case the analysis requires to take in account the age at the corresponding time instance of the measurement. The next chunk does this.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">&lt;-</span> <span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_updated <span class="op">=</span> <span class="va">age</span> <span class="op">+</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">age_updated</span>, .after <span class="op">=</span> <span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"cccccccc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in attr(x, "align"): 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated")</span></span>
<span><span class="co">#&gt; Warning in attr(x, "format"): 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">id</th>
<th style="text-align: center;">time</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">age_updated</th>
<th style="text-align: center;">bmi</th>
<th style="text-align: center;">country</th>
<th style="text-align: center;">abelisa</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">1.785124</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">35.51911</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">4.434470</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">35.54103</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">4.124822</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">35.58213</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">4.050954</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">35.74651</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">3.382073</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">Female</td>
<td style="text-align: center;">35.49993</td>
<td style="text-align: center;">35.99308</td>
<td style="text-align: center;">20.69408</td>
<td style="text-align: center;">West Africa</td>
<td style="text-align: center;">2.935390</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="the-bmi-variable" class="level3" data-number="1.4.3"><h3 data-number="1.4.3" class="anchored" data-anchor-id="the-bmi-variable">
<span class="header-section-number">1.4.3</span> The <code>bmi</code> variable</h3>
<p>Acounting for the fact that the <code>age</code> variable does not represent the age at the time of each measurement but rather the subject’s age at the beginning of the experiment, we start by checking if the <code>bmi</code> variable has the same interpretation, i.e.&nbsp;if it simply indicates the subject’s body mass index at the start of the experiment and it does not capture the subject’s BMI variation during the experiment:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_obs_per_subject</span> <span class="op">==</span> <span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">bmi</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Hence, it can be concluded that</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <code>bmi</code> variable represents the subject’s BMI at the beginning of the experiment and it is not accounting for the BMI variations during the experiment.</p>
</div>
</div>
</div>
<p>As before, we look at the density of <code>bmi</code> variable. The next chunk computes the denisty, showed in <a href="#fig-bmi-density" class="quarto-xref">Figure&nbsp;<span>1.9</span></a>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bmi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, fill <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"BMI density"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"BMI (kg/m²)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-bmi-density" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bmi-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-bmi-density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bmi-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.9: The density of <code>bmi</code> variable.
</figcaption></figure>
</div>
</div>
</div>
<p>The conditional densities and conditional boxplots (conditional on the categorical variables <code>sex</code> and <code>country</code>) are showed in <a href="#fig-bmi-densities-cond" class="quarto-xref">Figure&nbsp;<span>1.10</span></a> and <a href="#fig-bmi-boxplots-cond" class="quarto-xref">Figure&nbsp;<span>1.11</span></a>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bmi</span>, color <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"BMI densities for sex levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"BMI (kg/m²)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bmi</span>, color <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"BMI densities for region levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"BMI (kg/m²)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-bmi-densities-cond" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bmi-densities-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-bmi-densities-cond" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-bmi-densities-cond-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-bmi-densities-cond-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-bmi-densities-cond-1.png" id="fig-bmi-densities-cond-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-bmi-densities-cond" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bmi-densities-cond-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-bmi-densities-cond" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-bmi-densities-cond-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-bmi-densities-cond-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-bmi-densities-cond-2.png" id="fig-bmi-densities-cond-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-bmi-densities-cond" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bmi-densities-cond-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bmi-densities-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.10: The densities of <code>bmi</code> variable given <code>sex</code> and <code>country</code> variables.
</figcaption></figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">bmi</span>, x <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"BMI for sex levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"BMI (kg/m²)"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">bmi</span>, x <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"BMI for region levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"BMI (kg/m²)"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-bmi-boxplots-cond" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bmi-boxplots-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-bmi-boxplots-cond" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-bmi-boxplots-cond-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-bmi-boxplots-cond-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-bmi-boxplots-cond-1.png" id="fig-bmi-boxplots-cond-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-bmi-boxplots-cond" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bmi-boxplots-cond-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-bmi-boxplots-cond" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-bmi-boxplots-cond-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-bmi-boxplots-cond-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-bmi-boxplots-cond-2.png" id="fig-bmi-boxplots-cond-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-bmi-boxplots-cond" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bmi-boxplots-cond-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bmi-boxplots-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.11: The boxplots of <code>bmi</code> variable given <code>sex</code> and <code>country</code> variables.
</figcaption></figure>
</div>
</section><section id="the-abelisa-variable" class="level3" data-number="1.4.4"><h3 data-number="1.4.4" class="anchored" data-anchor-id="the-abelisa-variable">
<span class="header-section-number">1.4.4</span> The <code>abelisa</code> variable</h3>
<p>As before, we look at the density of <code>abelisa</code> variable. The next chunk computes the denisty, showed in <a href="#fig-abelisa-density" class="quarto-xref">Figure&nbsp;<span>1.12</span></a>,</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span>, fill <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration density"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Antibody concentration (EU/mL)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-density" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.12: The density of <code>abelisa</code> variable.
</figcaption></figure>
</div>
</div>
</div>
<p>the conditional densities are showed in <a href="#fig-abelisa-sex-country-density" class="quarto-xref">Figure&nbsp;<span>1.13</span></a></p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abelisa</span>, color <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody conc. densities for sex levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abelisa</span>, color <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody conc. densities for region levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-abelisa-sex-country-density" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-sex-country-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-sex-country-density" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-sex-country-density-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-sex-country-density-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-sex-country-density-1.png" id="fig-abelisa-sex-country-density-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-sex-country-density" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-sex-country-density-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-sex-country-density" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-sex-country-density-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-sex-country-density-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-sex-country-density-2.png" id="fig-abelisa-sex-country-density-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-sex-country-density" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-sex-country-density-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-sex-country-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.13: The density of <code>abelisa</code> variable given <code>sex</code> and <code>country</code> variables.
</figcaption></figure>
</div>
<p>and the conditional boxplots are showed in <a href="#fig-abelisa-sex-country-boxplot" class="quarto-xref">Figure&nbsp;<span>1.14</span></a></p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">abelisa</span>, x <span class="op">=</span> <span class="va">sex</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration for sex levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">abelisa</span>, x <span class="op">=</span> <span class="va">country</span>, fill <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration for region levels"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-abelisa-sex-country-boxplot" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-sex-country-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-sex-country-boxplot" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-sex-country-boxplot-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-sex-country-boxplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-sex-country-boxplot-1.png" id="fig-abelisa-sex-country-boxplot-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-sex-country-boxplot" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-sex-country-boxplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-sex-country-boxplot" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-sex-country-boxplot-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-sex-country-boxplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-sex-country-boxplot-2.png" id="fig-abelisa-sex-country-boxplot-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-sex-country-boxplot" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-sex-country-boxplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-sex-country-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.14: The boxplot of <code>abelisa</code> variable given <code>sex</code> and <code>country</code> variables.
</figcaption></figure>
</div>
<p>The next chunk computes the antibody concentration during time for all subjects in the data frame and it’s log version, showed in <a href="#fig-abelisa-all" class="quarto-xref">Figure&nbsp;<span>1.15</span></a>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span>, color <span class="op">=</span> <span class="va">bmi</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdPu"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration during time"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">abelisa</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">bmi</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdPu"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration during time"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"log(Time) (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"log(Antibody conc.) (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-abelisa-all" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-all" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-all-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-all-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-1.png" id="fig-abelisa-all-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-all" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-all-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-all" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-all-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-all-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-2.png" id="fig-abelisa-all-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-all" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-all-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.15: The antibody concentration during time for all subjects.
</figcaption></figure>
</div>
<p>The next chunk computes the average antibody concentration during time (based on the subjects in the data frame) and it’s log version, showed in <a href="#fig-abelisa-all-mean" class="quarto-xref">Figure&nbsp;<span>1.16</span></a>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_abelisa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">abelisa</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">time</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average antibody concentration during time"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_abelisa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">abelisa</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">time</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">mean_abelisa</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average antibody concentration during time"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-abelisa-all-mean" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-all-mean" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-all-mean-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-all-mean-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-mean-1.png" id="fig-abelisa-all-mean-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-all-mean" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-all-mean-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-all-mean" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-all-mean-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-all-mean-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-mean-2.png" id="fig-abelisa-all-mean-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-all-mean" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-all-mean-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.16: The average antibody concentration during time.
</figcaption></figure>
</div>
<p>The next chunk computes the antibody concentration during time for all subjects, for all levels of <code>country</code> and <code>sex</code> variables, showed in <a href="#fig-abelisa-all-per-levels" class="quarto-xref">Figure&nbsp;<span>1.17</span></a>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span>, color <span class="op">=</span> <span class="va">bmi</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdPu"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration during time"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-all-per-levels" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-per-levels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-per-levels-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-per-levels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.17: The antibody concentration during time for all subjects, for all levels of <code>country</code> and <code>sex</code> variables
</figcaption></figure>
</div>
</div>
</div>
<p>The next chunk computes the antibody concentration during time for all subjects, individually, showed in <a href="#fig-abelisa-all-per-subject" class="quarto-xref">Figure&nbsp;<span>1.18</span></a> (for clarity, title and axis names are removed).</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-all-per-subject" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-per-subject-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-per-subject-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-per-subject-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.18: The antibody concentration during time for all subjects, for all levels of <code>country</code> and <code>sex</code> variables
</figcaption></figure>
</div>
</div>
</div>
<p>The two aspects that are apparent in <a href="#fig-abelisa-all" class="quarto-xref">Figure&nbsp;<span>1.15</span></a>, <a href="#fig-abelisa-all-per-levels" class="quarto-xref">Figure&nbsp;<span>1.17</span></a> and fig-abelisa-all-per-subject are the following:</p>
<ul>
<li>A similar behavior (pattern) of the concentration levels during time (i.e.&nbsp;a very sudden increase followed by a slow decrease).</li>
<li>Variation in behavior between subjects: the amplitude of the initial spike varies, the rate of decrease varies. This variation is (partially) explained by the subject particular physiology.</li>
</ul></section></section><section id="an-approximation-function" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="an-approximation-function">
<span class="header-section-number">1.5</span> An approximation function</h2>
<p>The goal here is to find the analytical form of a exponential functional that can model the behavior of the antibody concentration during time.</p>
<p>Importantly, the behavior will be considered starting with day 7, which effectively means the exclusion of the the first (time) measurement for each subject in the data frame.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">&lt;-</span> <span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The antibody concentration is decreasing exponential and (apparently) platoes the following function is considered to model the antibody concentration:</p>
<p><span id="eq-f-approx"><span class="math display">
\begin{equation}
f(t)
=
\phi_1
+
\left(
\phi_2 - \phi_1
\right)
\exp(- \phi_3 t)
\end{equation}
\tag{1.1}</span></span></p>
<p>The parameters are computed in the following chunk:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">range_abelisa_average</span> <span class="op">&lt;-</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_abelisa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">abelisa</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">time</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">mean_abelisa</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">range_abelisa_average</span></span>
<span><span class="co">#&gt; [1] 2.752019 4.096533</span></span>
<span></span>
<span><span class="va">range_time</span> <span class="op">&lt;-</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">range_time</span></span>
<span><span class="co">#&gt; [1]   7 730</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f_approx</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">psi</span>, <span class="va">time</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">y_min</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">y_max</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">y_min</span> <span class="op">+</span> <span class="op">(</span><span class="va">y_max</span> <span class="op">-</span> <span class="va">y_min</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">rate</span> <span class="op">*</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">range_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">range_time</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#psi_vals &lt;- c(range_abelisa_average[1], range_abelisa_average[2], 0.007)</span></span>
<span><span class="va">psi_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">range_abelisa_average</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">range_abelisa_average</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">0.0065</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tb_f_approx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  time  <span class="op">=</span> <span class="va">time</span>,</span>
<span>  f <span class="op">=</span> <span class="fu">f_approx</span><span class="op">(</span><span class="va">psi_vals</span>, <span class="va">time</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_f_approx</span></span>
<span><span class="co">#&gt; # A tibble: 724 × 2</span></span>
<span><span class="co">#&gt;    time     f</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     7  4.04</span></span>
<span><span class="co">#&gt; 2     8  4.03</span></span>
<span><span class="co">#&gt; 3     9  4.02</span></span>
<span><span class="co">#&gt; 4    10  4.01</span></span>
<span><span class="co">#&gt; 5    11  4.00</span></span>
<span><span class="co">#&gt; 6    12  4.00</span></span>
<span><span class="co">#&gt; # ℹ 718 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">f</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_f_approx</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration vs. approx. func."</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_abelisa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">abelisa</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">time</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">f</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_f_approx</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average antibody conc. vs. approx func."</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-abelisa-vs-func-approx" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-vs-func-approx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-vs-func-approx" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-vs-func-approx-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-vs-func-approx-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-vs-func-approx-1.png" id="fig-abelisa-vs-func-approx-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-vs-func-approx" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-vs-func-approx-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-abelisa-vs-func-approx" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-abelisa-vs-func-approx-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" width="384">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-abelisa-vs-func-approx-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-vs-func-approx-2.png" id="fig-abelisa-vs-func-approx-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-abelisa-vs-func-approx" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-abelisa-vs-func-approx-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-vs-func-approx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.19: Antibody concentration vs.&nbsp;approximation function
</figcaption></figure>
</div>
</section><section id="non-linear-nl-model" class="level2" data-number="1.6"><h2 data-number="1.6" class="anchored" data-anchor-id="non-linear-nl-model">
<span class="header-section-number">1.6</span> Non-linear (NL) model</h2>
<p>In the following,</p>
<ul>
<li>
<span class="math inline">m</span> denotes the number of subjects,</li>
<li>
<span class="math inline">n</span> denotes the number of measurements (in this case the concentration measurements) for <em>each</em> subject taken at different time instants.</li>
</ul>
<p>The measurement corresponding to <span class="math inline">i</span><sup>th</sup> patient at the <span class="math inline">j</span><sup>th</sup> time instant is denoted by <span class="math inline">y_{ij}</span>, with</p>
<ul>
<li>
<span class="math inline">i = 1, \ldots, m</span>, (in this case <span class="math inline">m = 43</span>, accounting for the removed data with corresponding negative ages)</li>
<li>
<span class="math inline">j = 1, \ldots, n</span> (in this case <span class="math inline">n = 8</span>).</li>
</ul>
<p><span class="math inline">y_{ij}</span> is viewed as the dependent variable (in this case the <code>abelisa</code> variable representing the antibody concentration) of a <em>non-linear model</em>, writing</p>
<p><span id="eq-nlm"><span class="math display">
\begin{equation}
\begin{split}
y_{ij}
=
f(\bm{\psi}, t_j)
+
\epsilon_{ij}
,
\end{split}
\end{equation}
\tag{1.2}</span></span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">f</span> represents a non-linear model,</li>
<li>
<span class="math inline">t_j</span> represents the <span class="math inline">j</span><sup>th</sup> time instant,</li>
<li>
<span class="math inline">\bm{\psi}</span> represents the parameters vector,</li>
<li>
<span class="math inline">\epsilon_{ij}</span> accounts for the modeling error and uncertainty.</li>
</ul>
<section id="one-subject" class="level3" data-number="1.6.1"><h3 data-number="1.6.1" class="anchored" data-anchor-id="one-subject">
<span class="header-section-number">1.6.1</span> One subject</h3>
<p>Before considering the model <a href="#eq-nlm" class="quarto-xref">Equation&nbsp;<span>1.2</span></a> accounting for all subjects, a single subject is considered. For illustration, <a href="#fig-abelisa-one-subject" class="quarto-xref">Figure&nbsp;<span>1.20</span></a> shows the evolution of the antibody concentration during time for subject ID1.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="st">"ID1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">f</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_f_approx</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration during time for subject ID1"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-one-subject" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-one-subject-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-one-subject-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-one-subject-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.20: The antibody concentration during time for subject ID1
</figcaption></figure>
</div>
</div>
</div>
<p>In this case, the model writes</p>
<p><span id="eq-nlm-one"><span class="math display">
\begin{equation}
\begin{split}
y_{j} = f(\bm{\psi}, t_j) + \epsilon_j,
\end{split}
\end{equation}
\tag{1.3}</span></span></p>
<p>i.e.&nbsp;the subject’s index <span class="math inline">i</span> is dropped and the only measurement variation is due to the measurement timing, with the least-squares estimate given by</p>
<p><span id="eq-nlm-one-ls"><span class="math display">
\begin{equation}
\begin{split}
\widehat{\bm{\psi}}
=
\arg\min_{\bm{\psi}}
\sum_{j=1}^{n}
\left(
y_j
-
f(\bm{\psi}, t_j)
\right)^2
\end{split}
\end{equation}
\tag{1.4}</span></span></p>
<p>with</p>
<p><span id="eq-param"><span class="math display">
\begin{equation}
\begin{split}
\bm{\psi}
=
\begin{bmatrix}
\phi_1 &amp; \phi_2 &amp; \phi_3
\end{bmatrix}
.
\end{split}
\end{equation}
\tag{1.5}</span></span></p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nls_sub_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span></span>
<span>  <span class="va">abelisa</span> <span class="op">~</span> <span class="fu">f_approx</span><span class="op">(</span><span class="va">psi</span>, <span class="va">time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="st">"ID1"</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="va">psi_vals</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">nls_sub_1</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: abelisa ~ f_approx(psi, time)</span></span>
<span><span class="co">#&gt;    data: filter(tb_after_7, id == "ID1")</span></span>
<span><span class="co">#&gt;     psi1     psi2     psi3 </span></span>
<span><span class="co">#&gt; 2.369908 4.441104 0.007356 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 0.03733</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 6 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 6.02e-06</span></span>
<span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">nls_sub_1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">term</th>
<th style="text-align: center;">estimate</th>
<th style="text-align: center;">std.error</th>
<th style="text-align: center;">statistic</th>
<th style="text-align: center;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">psi1</td>
<td style="text-align: center;">2.3699077</td>
<td style="text-align: center;">0.0878109</td>
<td style="text-align: center;">26.988771</td>
<td style="text-align: center;">0.0000112</td>
</tr>
<tr class="even">
<td style="text-align: center;">psi2</td>
<td style="text-align: center;">4.4411042</td>
<td style="text-align: center;">0.0762377</td>
<td style="text-align: center;">58.253396</td>
<td style="text-align: center;">0.0000005</td>
</tr>
<tr class="odd">
<td style="text-align: center;">psi3</td>
<td style="text-align: center;">0.0073556</td>
<td style="text-align: center;">0.0010835</td>
<td style="text-align: center;">6.788539</td>
<td style="text-align: center;">0.0024586</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_sub_1_pred</span> <span class="op">&lt;-</span> <span class="va">tb_f_approx</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">nls_sub_1</span>, newdata <span class="op">=</span> <span class="va">tb_f_approx</span><span class="op">)</span>  </span>
<span>  <span class="op">)</span></span>
<span><span class="va">tb_sub_1_pred</span></span>
<span><span class="co">#&gt; # A tibble: 724 × 3</span></span>
<span><span class="co">#&gt;    time     f prediction</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     7  4.04       4.34</span></span>
<span><span class="co">#&gt; 2     8  4.03       4.32</span></span>
<span><span class="co">#&gt; 3     9  4.02       4.31</span></span>
<span><span class="co">#&gt; 4    10  4.01       4.29</span></span>
<span><span class="co">#&gt; 5    11  4.00       4.28</span></span>
<span><span class="co">#&gt; 6    12  4.00       4.27</span></span>
<span><span class="co">#&gt; # ℹ 718 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="st">"ID1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">f</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_sub_1_pred</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_sub_1_pred</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration vs. NLM pred"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-sub_1-vs-nlm-pred" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-sub_1-vs-nlm-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-sub_1-vs-nlm-pred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-sub_1-vs-nlm-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.21: The antibody concentration during time for subject ID1 vs.&nbsp;approximation function (green) vs.&nbsp;NLM prediction (blue)
</figcaption></figure>
</div>
</div>
</div>
</section><section id="multiple-subjects" class="level3" data-number="1.6.2"><h3 data-number="1.6.2" class="anchored" data-anchor-id="multiple-subjects">
<span class="header-section-number">1.6.2</span> Multiple subjects</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">f</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_f_approx</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration during time for all subjects"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-all-subjects" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-subjects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-subjects-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-subjects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.22: The antibody concentration during time for all subjects vs.&nbsp;approximation function
</figcaption></figure>
</div>
</div>
</div>
<p>The model for multiple subjects is given by <a href="#eq-nlm" class="quarto-xref">Equation&nbsp;<span>1.2</span></a> and the LS estimate is given by</p>
<p><span id="eq-nlm-ls"><span class="math display">
\begin{equation}
\begin{split}
\widehat{\bm{\psi}}
=
\arg\min_{\bm{\psi}}
\sum_{i=1}^{m}
\sum_{j=1}^{n}
\left(
y_{ij}
-
f(\bm{\psi}, t_j)
\right)^2
\end{split}
\end{equation}
\tag{1.6}</span></span></p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nls_sub_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span></span>
<span>  <span class="va">abelisa</span> <span class="op">~</span> <span class="fu">f_approx</span><span class="op">(</span><span class="va">psi</span>, <span class="va">time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tb_after_7</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="va">psi_vals</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">nls_sub_all</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: abelisa ~ f_approx(psi, time)</span></span>
<span><span class="co">#&gt;    data: tb_after_7</span></span>
<span><span class="co">#&gt;     psi1     psi2     psi3 </span></span>
<span><span class="co">#&gt; 2.743720 4.247855 0.009601 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 35.42</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 4 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 2.578e-06</span></span>
<span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">nls_sub_all</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"ccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: center;">term</th>
<th style="text-align: center;">estimate</th>
<th style="text-align: center;">std.error</th>
<th style="text-align: center;">statistic</th>
<th style="text-align: center;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">psi1</td>
<td style="text-align: center;">2.7437203</td>
<td style="text-align: center;">0.0419748</td>
<td style="text-align: center;">65.365923</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">psi2</td>
<td style="text-align: center;">4.2478547</td>
<td style="text-align: center;">0.0451069</td>
<td style="text-align: center;">94.173147</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">psi3</td>
<td style="text-align: center;">0.0096014</td>
<td style="text-align: center;">0.0010454</td>
<td style="text-align: center;">9.184298</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_sub_all_pred</span> <span class="op">&lt;-</span> <span class="va">tb_f_approx</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">nls_sub_all</span>, newdata <span class="op">=</span> <span class="va">tb_f_approx</span><span class="op">)</span>  </span>
<span>  <span class="op">)</span></span>
<span><span class="co"># tb_sub_all_pred</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">f</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_sub_all_pred</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_sub_all_pred</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Antibody concentration vs. NLM pred"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody conc. (EU/mL)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"BMI"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-all-vs-nlm-pred" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-vs-nlm-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-vs-nlm-pred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-vs-nlm-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.23: The antibody concentration during time for all subjects and vs.&nbsp;approximation function (green) vs.&nbsp;NLM prediction (blue)
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_sub_all_pred</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-all-invidiual-vs-nlm-pred" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-invidiual-vs-nlm-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-invidiual-vs-nlm-pred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-invidiual-vs-nlm-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.24: The antibody concentration during time for all subjects and the NLM prediction
</figcaption></figure>
</div>
</div>
</div>
</section><section id="multiple-models-fitted-on-multiple-subjects" class="level3" data-number="1.6.3"><h3 data-number="1.6.3" class="anchored" data-anchor-id="multiple-models-fitted-on-multiple-subjects">
<span class="header-section-number">1.6.3</span> Multiple models fitted on multiple subjects</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_subjects</span> <span class="op">&lt;-</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">available_ids_vec</span> <span class="op">&lt;-</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sub_indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">43</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psi_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">range_abelisa_average</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">range_abelisa_average</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">0.0065</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">available_ids_vec</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">nls_sub_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span></span>
<span>    <span class="va">abelisa</span> <span class="op">~</span> <span class="fu">f_approx</span><span class="op">(</span><span class="va">psi</span>, <span class="va">time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="va">psi_vals</span><span class="op">)</span></span>
<span>    <span class="op">)</span>  </span>
<span>  </span>
<span>  <span class="va">tb_sub_i_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">time</span>,</span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="va">i</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> </span>
<span>  </span>
<span>  <span class="va">tb_sub_i_pred</span> <span class="op">&lt;-</span> <span class="va">tb_sub_i_pred</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">nls_sub_i</span>, newdata <span class="op">=</span> <span class="va">tb_sub_i_pred</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sub_indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">sub_indiv</span>, <span class="va">tb_sub_i_pred</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="va">sub_indiv</span> <span class="op">&lt;-</span> <span class="va">sub_indiv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">id</span>, .before <span class="op">=</span> <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">sub_indiv</span></span>
<span><span class="co">#&gt; # A tibble: 31,132 × 3</span></span>
<span><span class="co">#&gt;   id     time  pred</span></span>
<span><span class="co">#&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ID1       7  4.34</span></span>
<span><span class="co">#&gt; 2 ID1       8  4.32</span></span>
<span><span class="co">#&gt; 3 ID1       9  4.31</span></span>
<span><span class="co">#&gt; 4 ID1      10  4.29</span></span>
<span><span class="co">#&gt; 5 ID1      11  4.28</span></span>
<span><span class="co">#&gt; 6 ID1      12  4.27</span></span>
<span><span class="co">#&gt; # ℹ 31,126 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">abelisa</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"tomato"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sub_indiv</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">pred</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">id</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-abelisa-all-invidiual-vs-nlm-individual-pred" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-abelisa-all-invidiual-vs-nlm-individual-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-abelisa-all-invidiual-vs-nlm-individual-pred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelisa-all-invidiual-vs-nlm-individual-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.25: The antibody concentration during time for all subjects and the NLM individual predictions
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="non-linear-mixed-effects-nlme-model---no-covariates" class="level2" data-number="1.7"><h2 data-number="1.7" class="anchored" data-anchor-id="non-linear-mixed-effects-nlme-model---no-covariates">
<span class="header-section-number">1.7</span> Non-linear mixed effects (NLME) model - no covariates</h2>
<p>Will be done via stochastic approximation expectation maximization (SAEM) using the <code>saemix</code> package.</p>
<p>First thing: account for the specificity of <code>saemix</code> which expects the <code>id</code> column in the data frame to be of numerical type. The next chunk is re-transforming the <code>id</code> column in the tibble into a numerical variable and parse the numerical value (i.e.&nbsp;removes “ID” from “IDi”)</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_after_7</span> <span class="op">&lt;-</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">tb_after_7</span></span>
<span><span class="co">#&gt; # A tibble: 301 × 8</span></span>
<span><span class="co">#&gt;      id  time sex      age age_updated   bmi country     abelisa</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     7 Female  35.5        35.5  20.7 West Africa    4.43</span></span>
<span><span class="co">#&gt; 2     1    15 Female  35.5        35.5  20.7 West Africa    4.12</span></span>
<span><span class="co">#&gt; 3     1    30 Female  35.5        35.6  20.7 West Africa    4.05</span></span>
<span><span class="co">#&gt; 4     1    90 Female  35.5        35.7  20.7 West Africa    3.38</span></span>
<span><span class="co">#&gt; 5     1   180 Female  35.5        36.0  20.7 West Africa    2.94</span></span>
<span><span class="co">#&gt; 6     1   365 Female  35.5        36.5  20.7 West Africa    2.61</span></span>
<span><span class="co">#&gt; # ℹ 295 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The next chunk is defining the data as a <code>saemix</code> object, via <code>saemixData</code>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_data_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/saemixData.html">saemixData</a></span><span class="op">(</span></span>
<span>  name.data <span class="op">=</span> <span class="va">tb_after_7</span>,</span>
<span>  name.group <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  name.predictors <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  name.response <span class="op">=</span> <span class="st">"abelisa"</span>,</span>
<span>  units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days"</span>, y <span class="op">=</span> <span class="st">"EU/ml"</span><span class="op">)</span>,</span>
<span>  automatic <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following SaemixData object was successfully created:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Object of class SaemixData</span></span>
<span><span class="co">#&gt;     longitudinal data for use with the SAEM algorithm</span></span>
<span><span class="co">#&gt; Dataset tb_after_7 </span></span>
<span><span class="co">#&gt;     Structured data: abelisa ~ time | id </span></span>
<span><span class="co">#&gt;     Predictor: time (Days)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_data_nlme</span></span>
<span><span class="co">#&gt; Object of class SaemixData</span></span>
<span><span class="co">#&gt;     longitudinal data for use with the SAEM algorithm</span></span>
<span><span class="co">#&gt; Dataset tb_after_7 </span></span>
<span><span class="co">#&gt;     Structured data: abelisa ~ time | id </span></span>
<span><span class="co">#&gt; 301     observations in 43 subjects</span></span>
<span><span class="co">#&gt; First lines of data:</span></span>
<span><span class="co">#&gt;    id time  abelisa mdv cens occ ytype</span></span>
<span><span class="co">#&gt; 1   1    7 4.434471   0    0   1     1</span></span>
<span><span class="co">#&gt; 2   1   15 4.124822   0    0   1     1</span></span>
<span><span class="co">#&gt; 3   1   30 4.050954   0    0   1     1</span></span>
<span><span class="co">#&gt; 4   1   90 3.382073   0    0   1     1</span></span>
<span><span class="co">#&gt; 5   1  180 2.935390   0    0   1     1</span></span>
<span><span class="co">#&gt; 6   1  365 2.606559   0    0   1     1</span></span>
<span><span class="co">#&gt; 7   1  730 2.308632   0    0   1     1</span></span>
<span><span class="co">#&gt; 8   2    7 3.664922   0    0   1     1</span></span>
<span><span class="co">#&gt; 9   2   15 4.143873   0    0   1     1</span></span>
<span><span class="co">#&gt; 10  2   30 3.967767   0    0   1     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next chunk implements the function from <a href="#eq-f-approx" class="quarto-xref">Equation&nbsp;<span>1.1</span></a>:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">function_approx</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">psi</span>, <span class="va">id</span>, <span class="va">xidep</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="va">xidep</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">y_min</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">y_max</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">fpred</span> <span class="op">&lt;-</span> <span class="va">y_min</span> <span class="op">+</span> <span class="op">(</span><span class="va">y_max</span> <span class="op">-</span> <span class="va">y_min</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">rate</span> <span class="op">*</span> <span class="va">time</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">fpred</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#function_approx</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The next chunk is defining the nlme model as a <code>saemix</code> object, via <code>saemixModel</code> function. The model is given by <a href="#eq-f-approx" class="quarto-xref">Equation&nbsp;<span>1.1</span></a>, the initial values for <span class="math inline">\phi_1</span> and <span class="math inline">\phi_2</span> are set via the range computed over the complete data and the rate <span class="math inline">r</span> is set at <span class="math inline">0.05</span>. The model considers random effects on all three parameters &amp; constant variance, <code>error.model = "constant"</code>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_model_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/saemixModel.html">saemixModel</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">function_approx</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Approx function"</span>, </span>
<span>  psi0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.6</span>, <span class="fl">4.9</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>, </span>
<span>    byrow <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y_min"</span>, <span class="st">"y_max"</span>, <span class="st">"rate"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  transform.par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,   <span class="co"># log-transform rate only</span></span>
<span>  covariance.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,  <span class="co"># random effects on all</span></span>
<span>  error.model <span class="op">=</span> <span class="st">"constant"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following SaemixModel object was successfully created:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Nonlinear mixed-effects model</span></span>
<span><span class="co">#&gt;   Model function:  Approx function</span></span>
<span><span class="co">#&gt;   Model type:  structural</span></span>
<span><span class="co">#&gt; function(psi, id, xidep){</span></span>
<span><span class="co">#&gt;   time &lt;- xidep[, 1]</span></span>
<span><span class="co">#&gt;   y_min &lt;- psi[id, 1]</span></span>
<span><span class="co">#&gt;   y_max &lt;- psi[id, 2]</span></span>
<span><span class="co">#&gt;   rate &lt;- psi[id, 3]</span></span>
<span><span class="co">#&gt;   fpred &lt;- y_min + (y_max - y_min) * exp(-rate * time)</span></span>
<span><span class="co">#&gt;   return(fpred)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;   Nb of parameters: 3 </span></span>
<span><span class="co">#&gt;       parameter names:  y_min y_max rate </span></span>
<span><span class="co">#&gt;       distribution:</span></span>
<span><span class="co">#&gt;      Parameter Distribution Estimated</span></span>
<span><span class="co">#&gt; [1,] y_min     normal       Estimated</span></span>
<span><span class="co">#&gt; [2,] y_max     normal       Estimated</span></span>
<span><span class="co">#&gt; [3,] rate      log-normal   Estimated</span></span>
<span><span class="co">#&gt;   Variance-covariance matrix:</span></span>
<span><span class="co">#&gt;       y_min y_max rate</span></span>
<span><span class="co">#&gt; y_min     1     0    0</span></span>
<span><span class="co">#&gt; y_max     0     1    0</span></span>
<span><span class="co">#&gt; rate      0     0    1</span></span>
<span><span class="co">#&gt;   Error model: constant , initial values: a.1=1 </span></span>
<span><span class="co">#&gt;     No covariate in the model.</span></span>
<span><span class="co">#&gt;     Initial values</span></span>
<span><span class="co">#&gt;              y_min y_max rate</span></span>
<span><span class="co">#&gt; Pop.CondInit   1.6   4.9 0.05</span></span>
<span><span class="co"># saemix_model_nlme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The next chunk is defining the nlme model’s parameters as a (regular R) list:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_options_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  save.graph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  displayProgress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  print <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#saemix_options_nlme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The next chunk is fitting the nlme model, a <code>saemix</code> object, created via <code>saemix</code> function.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_fit_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/saemix.html">saemix</a></span><span class="op">(</span></span>
<span>  <span class="va">saemix_model_nlme</span>,</span>
<span>  <span class="va">saemix_data_nlme</span>,</span>
<span>  <span class="va">saemix_options_nlme</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Simulating data using nsim = 1000 simulated datasets</span></span>
<span><span class="co">#&gt; Computing WRES and npde .....</span></span>
<span><span class="co">#&gt; Simulating data using nsim = 1000 simulated datasets</span></span>
<span><span class="co">#&gt; Computing WRES and npde .....</span></span>
<span><span class="co">#&gt; Simulating data using nsim = 1000 simulated datasets</span></span>
<span><span class="co">#&gt; Computing WRES and npde .....</span></span>
<span><span class="co"># saemix_fit_nlme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The results are</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_fit_nlme</span><span class="op">@</span><span class="va">results</span></span>
<span><span class="co">#&gt; Fixed effects</span></span>
<span><span class="co">#&gt;  Parameter Estimate   SE      CV(%)</span></span>
<span><span class="co">#&gt;  y_min     2.74135  0.050503 1.84  </span></span>
<span><span class="co">#&gt;  y_max     4.24859  0.052600 1.24  </span></span>
<span><span class="co">#&gt;  rate      0.00961  0.000756 7.87  </span></span>
<span><span class="co">#&gt;  a.1       0.25759  0.012961 5.03  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance of random effects</span></span>
<span><span class="co">#&gt;  Parameter    Estimate   SE    CV(%)  </span></span>
<span><span class="co">#&gt;  omega2.y_min 6.85e-02 0.0201     29.3</span></span>
<span><span class="co">#&gt;  omega2.y_max 7.12e-02 0.0221     31.0</span></span>
<span><span class="co">#&gt;  omega2.rate  1.75e-05 0.0408 233084.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical criteria</span></span>
<span><span class="co">#&gt; Likelihood computed by linearisation</span></span>
<span><span class="co">#&gt;       -2LL= 150.281 </span></span>
<span><span class="co">#&gt;        AIC= 164.281 </span></span>
<span><span class="co">#&gt;        BIC= 176.6094 </span></span>
<span><span class="co">#&gt; Likelihood computed by importance sampling</span></span>
<span><span class="co">#&gt;       -2LL= 150.0711 </span></span>
<span><span class="co">#&gt;        AIC= 164.0711 </span></span>
<span><span class="co">#&gt;        BIC= 176.3995</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_fit_nlme</span><span class="op">@</span><span class="va">results</span><span class="op">@</span><span class="va">fixed.effects</span></span>
<span><span class="co">#&gt; [1] 2.741351986 4.248585754 0.009611671</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following chunk plots the comparison between the observed and the (individual and population) prediction for subject 1:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_with_preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/saemix.predict.html">saemix.predict</a></span><span class="op">(</span><span class="va">saemix_fit_nlme</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simulating data using nsim = 1000 simulated datasets</span></span>
<span><span class="co">#&gt; Computing WRES and npde .....</span></span>
<span><span class="va">tb_data</span> <span class="op">&lt;-</span> <span class="va">fit_with_preds</span><span class="op">@</span><span class="va">data</span><span class="op">@</span><span class="va">data</span></span>
<span><span class="va">tb_predictions</span> <span class="op">&lt;-</span> <span class="va">fit_with_preds</span><span class="op">@</span><span class="va">results</span><span class="op">@</span><span class="va">predictions</span></span>
<span></span>
<span><span class="va">tb_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tb_data</span>, <span class="va">tb_predictions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">tb_complete</span>, <span class="va">id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">abelisa</span>, color <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ipred</span>, color <span class="op">=</span> <span class="st">"Individual prediction"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ppred</span>, color <span class="op">=</span> <span class="st">"Population prediction"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Observed"</span> <span class="op">=</span> <span class="st">"tomato"</span>,</span>
<span>      <span class="st">"Individual prediction"</span> <span class="op">=</span> <span class="st">"darkseagreen"</span>,</span>
<span>      <span class="st">"Population prediction"</span> <span class="op">=</span> <span class="st">"violet"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"Subject"</span>, <span class="fl">1</span>, <span class="st">": Obs vs. Pred"</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Antibody levels (EU/ml)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="ebola_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The following chunk plots the comparison between the observed and the (individual and population) prediction for the subjects in the data set.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tb_complete</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">abelisa</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"tomato"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ipred</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkseagreen"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ppred</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"violet"</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="ebola_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/psi-methods.html">psi</a></span><span class="op">(</span><span class="va">saemix_fit_nlme</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rowid_to_column</a></span><span class="op">(</span><span class="st">"iteration"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iteration</span>, y <span class="op">=</span> <span class="va">y_min</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Iteration"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"y_min"</span>    </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iteration</span>, y <span class="op">=</span> <span class="va">y_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Iteration"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"y_max"</span>    </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iteration</span>, y <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Iteration"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"rate"</span>    </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-fixed-effects-iterations" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-fixed-effects-iterations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fixed-effects-iterations" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-fixed-effects-iterations-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-fixed-effects-iterations-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-fixed-effects-iterations-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-fixed-effects-iterations" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fixed-effects-iterations-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) y_min
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fixed-effects-iterations" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-fixed-effects-iterations-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-fixed-effects-iterations-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-fixed-effects-iterations-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-fixed-effects-iterations" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fixed-effects-iterations-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) y_max
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fixed-effects-iterations" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-fixed-effects-iterations-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-fixed-effects-iterations-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ebola_files/figure-html/fig-fixed-effects-iterations-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-fixed-effects-iterations" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fixed-effects-iterations-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) rate
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fixed-effects-iterations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.26: Fixed effects during iterations
</figcaption></figure>
</div>
</section><section id="non-linear-mixed-effects-nlme-model---covariates" class="level2" data-number="1.8"><h2 data-number="1.8" class="anchored" data-anchor-id="non-linear-mixed-effects-nlme-model---covariates">
<span class="header-section-number">1.8</span> Non-linear mixed effects (NLME) model - covariates</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_data_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/saemixData.html">saemixData</a></span><span class="op">(</span></span>
<span>  name.data <span class="op">=</span> <span class="va">tb_after_7</span>,</span>
<span>  name.group <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  name.predictors <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  name.response <span class="op">=</span> <span class="st">"abelisa"</span>,</span>
<span>  name.covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, <span class="co"># age added as covariate </span></span>
<span>  units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days"</span>, y <span class="op">=</span> <span class="st">"EU/ml"</span><span class="op">)</span>,</span>
<span>  automatic <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following SaemixData object was successfully created:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Object of class SaemixData</span></span>
<span><span class="co">#&gt;     longitudinal data for use with the SAEM algorithm</span></span>
<span><span class="co">#&gt; Dataset tb_after_7 </span></span>
<span><span class="co">#&gt;     Structured data: abelisa ~ time | id </span></span>
<span><span class="co">#&gt;     Predictor: time (Days) </span></span>
<span><span class="co">#&gt;     covariates: age (-)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">saemix_data_nlme</span></span>
<span><span class="co">#&gt; Object of class SaemixData</span></span>
<span><span class="co">#&gt;     longitudinal data for use with the SAEM algorithm</span></span>
<span><span class="co">#&gt; Dataset tb_after_7 </span></span>
<span><span class="co">#&gt;     Structured data: abelisa ~ time | id </span></span>
<span><span class="co">#&gt;     covariates: age (-) </span></span>
<span><span class="co">#&gt; 301     observations in 43 subjects</span></span>
<span><span class="co">#&gt; First lines of data:</span></span>
<span><span class="co">#&gt;    id time  abelisa      age mdv cens occ ytype</span></span>
<span><span class="co">#&gt; 1   1    7 4.434471 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 2   1   15 4.124822 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 3   1   30 4.050954 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 4   1   90 3.382073 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 5   1  180 2.935390 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 6   1  365 2.606559 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 7   1  730 2.308632 35.49993   0    0   1     1</span></span>
<span><span class="co">#&gt; 8   2    7 3.664922 41.95419   0    0   1     1</span></span>
<span><span class="co">#&gt; 9   2   15 4.143873 41.95419   0    0   1     1</span></span>
<span><span class="co">#&gt; 10  2   30 3.967767 41.95419   0    0   1     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The decay rate <span class="math inline">\phi_3</span> is assumed to depend on <code>age</code> through a linear relationship on the log scale, i.e.&nbsp;</p>
<p><span id="eq-log-scale-regression-age"><span class="math display">
\begin{equation}
\log(\psi^{i}_3)
=
\log(\psi_3)
+
\beta_{\text{age}}
\left(
\text{age}_i
-
\overline{\text{age}}
+
\nu^{i}
.
\right)
\end{equation}
\tag{1.7}</span></span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mean_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tb_after_7</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">function_approx_age</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">psi</span>, <span class="va">id</span>, <span class="va">xidep</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="va">xidep</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">covariates</span> <span class="op">&lt;-</span> <span class="va">xidep</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">y_min</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">y_max</span> <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">rate</span>  <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">beta</span>  <span class="op">&lt;-</span> <span class="va">psi</span><span class="op">[</span><span class="va">id</span>, <span class="fl">4</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">age</span> <span class="op">&lt;-</span> <span class="va">covariates</span><span class="op">[</span>, <span class="st">"age"</span><span class="op">]</span></span>
<span>  <span class="va">rate_i</span> <span class="op">&lt;-</span> <span class="va">rate</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">beta</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="va">mean_age</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">y_min</span> <span class="op">+</span> <span class="op">(</span><span class="va">y_max</span> <span class="op">-</span> <span class="va">y_min</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">rate_i</span> <span class="op">*</span> <span class="va">time</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psi0_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.6</span>, <span class="fl">4.9</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y_min"</span>, <span class="st">"y_max"</span>, <span class="st">"rate"</span>, <span class="st">"beta_age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">covariate_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>  <span class="co"># only 'rate' affected by age</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covariance_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># random effects only on first 3</span></span>
<span></span>
<span><span class="va">saemix_model_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/saemixModel.html">saemixModel</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">function_approx_age</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Nonlinear model with age effect on rate"</span>,</span>
<span>  psi0 <span class="op">=</span> <span class="va">psi0_vals</span>,</span>
<span>  transform.par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  covariate.model <span class="op">=</span> <span class="va">covariate_matrix</span>,</span>
<span>  covariance.model <span class="op">=</span> <span class="va">covariance_matrix</span>,</span>
<span>  error.model <span class="op">=</span> <span class="st">"constant"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in dimnames(x) &lt;- dn : </span></span>
<span><span class="co">#&gt;   length of 'dimnames' [2] not equal to array extent</span></span>
<span><span class="co">#&gt; [1] "Creation of SaemixModel failed"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># saemix_fit_nlme &lt;- saemix(</span></span>
<span><span class="co">#   saemix_model_nlme,</span></span>
<span><span class="co">#   saemix_data_nlme,</span></span>
<span><span class="co">#   saemix_options_nlme</span></span>
<span><span class="co">#   )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># saemix_fit_nlme@results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># saemix_fit_nlme@results@fixed.effects</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fit nonlinear mixed model</span></span>
<span><span class="co"># nlme_sub_all &lt;- nlme(</span></span>
<span><span class="co">#   model = abelisa ~ f_approx_2(y_min, y_max, rate, time),</span></span>
<span><span class="co">#   data = tb_after_7,</span></span>
<span><span class="co">#   fixed = y_min + y_max + rate ~ 1,</span></span>
<span><span class="co">#   random = y_min ~ 1 | id,</span></span>
<span><span class="co">#   start = psi_vals,</span></span>
<span><span class="co">#   control = nlmeControl(msMaxIter = 200)</span></span>
<span><span class="co">#   )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># nlme_sub_all</span></span>
<span></span>
<span></span>
<span><span class="co"># nlme_fit &lt;- nlme(</span></span>
<span><span class="co">#   model = y ~ logistic_model(Asym, Rate, xmid, time),</span></span>
<span><span class="co">#   data = data,</span></span>
<span><span class="co">#   fixed = Asym + Rate + xmid ~ 1,</span></span>
<span><span class="co">#   random = Asym + Rate ~ 1 | subject,  # Random effects on Asym and Rate</span></span>
<span><span class="co">#   start = c(Asym = 90, Rate = 0.2, xmid = 4.5),</span></span>
<span><span class="co">#   control = nlmeControl(msMaxIter = 200)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># nlme_fit</span></span>
<span></span>
<span></span>
<span><span class="co">#broom::tidy(nlme_sub_all) |&gt;</span></span>
<span><span class="co">#  knitr::kable(align = "ccc")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="the-model-proposed-by-pasin2019" class="level2" data-number="1.9"><h2 data-number="1.9" class="anchored" data-anchor-id="the-model-proposed-by-pasin2019">
<span class="header-section-number">1.9</span> The model proposed by <span class="citation" data-cites="pasin2019">(<a href="#ref-pasin2019" role="doc-biblioref">Pasin et al. 2019</a>)</span>
</h2>
<p>The non-linear model proposed in <span class="citation" data-cites="pasin2019">(<a href="#ref-pasin2019" role="doc-biblioref">Pasin et al. 2019</a>)</span> based on three compartments, i.e.&nbsp;the SL cells (<span class="math inline">S</span>), the LL cells (<span class="math inline">L</span>) and the antibodies (<span class="math inline">A</span>) writes</p>
<p><span id="eq-ode-0"><span class="math display">
\begin{equation}
\begin{split}
\frac{\text{d}S}{\text{d}t}
&amp;
=
-
\delta_S S
,
\\
\frac{\text{d}L}{\text{d}t}
&amp;
=
-
\delta_L L
,
\\
\frac{\text{d}A}{\text{d}t}
&amp;
=
\theta_S S
+
\theta_L L
-
\delta_S A
,
\end{split}
\end{equation}
\tag{1.8}</span></span></p>
<p>with</p>
<ul>
<li><p><span class="math inline">\delta_S</span> representing the decay rate over time of the long-lived (SL) antibody-secreting cells,</p></li>
<li><p><span class="math inline">\theta_S</span> representing the antibodies production rate of SL antibody-secreting cells,</p></li>
<li><p><span class="math inline">\delta_L</span> representing the decay rate over time of the long-lived (LL) antibodies,</p></li>
<li><p><span class="math inline">\theta_L</span> representing the antibodies production rate of LL antibody-secreting cells,</p></li>
<li><p><span class="math inline">\delta_A</span> representing the decay rate of antibodies.</p></li>
</ul>
<p>The equation for the antibodies <span class="math inline">A</span> is the non-homogeneous linear ordinary differential equation (ODE) given by:</p>
<p><span id="eq-ode-1"><span class="math display">
\begin{equation}
\frac{\text{d}A}{\text{d}t}
=
\phi_S
\exp{\left(-\delta_S t \right)}
+
\phi_L
\exp{\left( -\delta_L t \right)}
-
\delta_A
A
,
\end{equation}
\tag{1.9}</span></span></p>
<p>with</p>
<p><span id="eq-ode-1a"><span class="math display">
\begin{equation}
\phi_S = \theta_S S_0,
\quad
S_0 = S(0)
,
\end{equation}
\tag{1.10}</span></span></p>
<p>and <span id="eq-ode-1b"><span class="math display">
\begin{equation}
\phi_L = \theta_L L_0,
\quad
L_0 = L(0)
,
\end{equation}
\tag{1.11}</span></span></p>
<p><a href="#eq-ode-1" class="quarto-xref">Equation&nbsp;<span>1.9</span></a> writes</p>
<p><span id="eq-ode-2"><span class="math display">
\begin{equation}
\frac{\text{d}A}{\text{d}t}
+ \delta_A A
=
\phi_S \exp(-\delta_S t)
+
\phi_L \exp(-\delta_L t)
\end{equation}
\tag{1.12}</span></span></p>
<p>or equivalently</p>
<p><span id="eq-ode-3"><span class="math display">
\begin{equation}
\frac{\text{d}A}{\text{d}t} + P(t) A = Q(t)
\end{equation}
\tag{1.13}</span></span></p>
<p>with:</p>
<ul>
<li>
<span class="math inline">P(t) = \delta_f</span> (i.e.&nbsp;constant),</li>
<li>
<span class="math inline">Q(t) = \phi_S \exp(-\delta_S t) + \phi_L \exp(-\delta_L t)</span>.</li>
</ul>
<p>The homogeneous equation writes</p>
<p><span id="eq-ode-4"><span class="math display">
\begin{equation}
\frac{\text{d}A}{\text{d}t}
+
\delta_A
A
=
0
,
\end{equation}
\tag{1.14}</span></span></p>
<p>with the solution</p>
<p><span id="eq-ode-5"><span class="math display">
\begin{equation}
A_h(t)
=
c
\exp(-\delta_A t)
,
\end{equation}
\tag{1.15}</span></span></p>
<p>with <span class="math inline">c</span> a constant determined by the initial conditions (i.e <span class="math inline">A(0)</span>). The non-homogeneous part can be solved using an integrating factor. Let the integrating factor be</p>
<p><span id="eq-ode-6"><span class="math display">
\begin{equation}
\mu(t)
=
\exp{
\left(
\int \delta_A \text{d}t
\right)
}
=
\exp{(\delta_A t)}
,
\end{equation}
\tag{1.16}</span></span></p>
<p>and multiplying by the integrating factor, <a href="#eq-ode-2" class="quarto-xref">Equation&nbsp;<span>1.12</span></a> writes</p>
<p><span id="eq-ode-7"><span class="math display">
\begin{equation}
\begin{split}
\frac{\text{d} }{\text{d}t}
\left(
\exp(\delta_f t) f(t)
\right)
&amp;
=
\phi_S
\exp
\left(
(\delta_A - \delta_S) t
\right)
\\
&amp;
+
\phi_L
\exp
\left(
(\delta_A - \delta_L) t
\right)
.
\end{split}
\end{equation}
\tag{1.17}</span></span></p>
<p>Integrating both sides (with respect to <span class="math inline">t</span>) writes:</p>
<p><span id="eq-ode-8"><span class="math display">
\begin{equation}
\begin{split}
\exp(\delta_A t) f(t)
&amp;
=
\phi_S
\int
\exp{
\left( (\delta_A - \delta_S) t \right)
}
\text{d}t
\\
&amp;
+
\phi_L
\int
\exp{
\left( (\delta_A - \delta_L) t \right)
}
\text{d}t
.
\end{split}
\end{equation}
\tag{1.18}</span></span></p>
<p>The first integral writes</p>
<p><span id="eq-ode-9"><span class="math display">
\begin{equation}
\int
\exp
\left(
(\delta_A - \delta_S)
t
\right)
\text{d}t
=
\frac{1}{\delta_A - \delta_S}
\exp
\left(
(\delta_A - \delta_S)
t
\right)
+
c_1
,
\end{equation}
\tag{1.19}</span></span></p>
<p>and the second integral writes</p>
<p><span id="eq-ode-10"><span class="math display">
\begin{equation}
\int
\exp
\left(
(\delta_A - \delta_L)
t
\right)
\text{d}t
=
\frac{1}{\delta_A - \delta_L}
\exp
\left(
(\delta_A - \delta_L)
t
\right)
+
c_2
.
\end{equation}
\tag{1.20}</span></span></p>
<p>Plugging <a href="#eq-ode-9" class="quarto-xref">Equation&nbsp;<span>1.19</span></a> and <a href="#eq-ode-10" class="quarto-xref">Equation&nbsp;<span>1.20</span></a> in <a href="#eq-ode-8" class="quarto-xref">Equation&nbsp;<span>1.18</span></a> writes</p>
<p><span id="eq-ode-11"><span class="math display">
\begin{equation}
\begin{split}
\exp(\delta_A t) f(t)
&amp;
=
\frac{\phi_S}{\delta_A - \delta_S}
\exp
\left(
(\delta_A - \delta_S)
t
\right)
\\
&amp;
+
\frac{\phi_L}{\delta_A - \delta_L}
\exp
\left(
(\delta_A - \delta_L)
t
\right)
\\
&amp;
+
c
.
\end{split}
\end{equation}
\tag{1.21}</span></span></p>
<p>hence</p>
<p><span id="eq-ode-12"><span class="math display">
\begin{equation}
\begin{split}
A(t)
&amp;
=
c
\exp(-\delta_A t)
\\
&amp;
+
\frac{\phi_S}{\delta_A - \delta_S}
\exp \left( -\delta_S t \right)
\\
&amp;
+
\frac{\phi_L}{\delta_A - \delta_L}
\exp \left( -\delta_L t \right)
,
\end{split}
\end{equation}
\tag{1.22}</span></span></p>
<p>with <span class="math inline">c</span> a constant determined by the initial condition (i.e.&nbsp;<span class="math inline">A(0)</span>) plugged-in from the data, i.e.&nbsp;the <code>abelisa</code> value corresponding to the second time instance measurement (i.e.&nbsp;the 7 days corresponding measurement). Assuming the second time instance measurement is <span class="math inline">A(0) = a</span>, the constant writes</p>
<p><span id="eq-ode-13"><span class="math display">
\begin{equation}
c
=
a
-
\frac{\phi_S}{\delta_A - \delta_S}
-
\frac{\phi_L}{\delta_A - \delta_L}
.
\end{equation}
\tag{1.23}</span></span></p>
<p>Let <span class="math inline">\bm{\psi}</span> denote the vector of parameters for the decay rates (LL antibodies, SL antibodies and antibodies) and <span class="math inline">\phi_S</span> and <span class="math inline">\phi_L</span></p>
<p><span id="eq-param-vec"><span class="math display">
\begin{equation}
\bm{\psi}=
\begin{bmatrix}
\phi_S &amp; \delta_S &amp; \phi_L &amp; \delta_L &amp; \delta_{Ab}
\end{bmatrix}
.
\end{equation}
\tag{1.24}</span></span></p>
<p>The following mixed-effect model each parameter <span class="math inline">\xi_{k}</span>, with <span class="math inline">k = 1, \ldots, 5</span> is considered:</p>
<p><span id="eq-nlme-model"><span class="math display">
\begin{equation}
\log{\left( \xi_{k}^{i} \right)}
=
\log{\left( \xi_{k0} \right)}
+
\bm{\beta}^{T}_{k}
\mathbf{z}_{k}^{i}
+
\nu_{k}^{i}
,
\end{equation}
\tag{1.25}</span></span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\xi^{i}_{k}</span> represents the <span class="math inline">k</span><sup>th</sup> parameters corresponding to the <span class="math inline">i</span><sup>th</sup> subject,</p></li>
<li><p><span class="math inline">\xi_{k0}</span> represents the <em>fixed effect</em> corresponding to the <span class="math inline">k</span><sup>th</sup> element of the parameters vector,</p></li>
<li><p><span class="math inline">\mathbf{z}^{i}_{k}</span> represents the vector of independent variables of the model,</p></li>
<li><p><span class="math inline">\bm{\beta}_{k}</span> represents the coefficents corresponding to <span class="math inline">\mathrm{z}^{i}_{k}</span>,</p></li>
<li>
<p><span class="math inline">\nu^{i}_{k}</span> represents the <em>individual effect</em>, assumed to</p>
<ul>
<li>follow a centered normal distributed with variance <span class="math inline">\omega_{k}^{2}</span>
</li>
</ul>
<p><span id="eq-nlme-model-1"><span class="math display">
\begin{equation}
\nu^{i}_{k}
\sim
\mathcal N \left( 0, \omega_{k}^{2} \right)
\end{equation}
\tag{1.26}</span></span></p>
<ul>
<li>be mutually independent</li>
</ul>
<p><span id="eq-nlme-model-2"><span class="math display">
\begin{equation}
\nu^{i}_{k} \perp \!\!\!\! \perp\nu^{j}_{l}
\end{equation}
\tag{1.27}</span></span></p>
</li>
</ul>
<p>The antibody concentration for patient <span class="math inline">i</span> at the <span class="math inline">j</span>th time instance measurement is assumed to be an additional error model</p>
<p><span id="eq-nlme-model-3"><span class="math display">
\begin{equation}
\mathrm{y}_{ij}
=
\log_{10}
\left(
A(\bm{\psi}^{i},t_{ij})
\right)
+
\epsilon_{ij}
,
\end{equation}
\tag{1.28}</span></span></p>
<p>with the noise following a centered normal distributed with the same variance <span class="math inline">\omega_{A}^{2}</span> (homoscedasticity), i.e.</p>
<p><span id="eq-nlme-model-4"><span class="math display">
\begin{equation}
\epsilon_{ij}
\sim
\mathcal N \left( 0, \sigma_{A}^{2} \right)
.
\end{equation}
\tag{1.29}</span></span></p>
<p>The complete set of model’s parameters is</p>
<p><span id="eq-nlme-model-5"><span class="math display">
\begin{equation}
\bm{\theta}
=
\begin{bmatrix}
\left( \xi_{k0} \right)_{k = 1, 5}
&amp;
\left( \bm{\beta}_{k} \right)_{k = 1, 5}
&amp;
\left( \omega_{k} \right)_{k = 1, 5}
&amp;
\sigma_{A}
\end{bmatrix}
\end{equation}
\tag{1.30}</span></span></p>
<p>Centering the age in the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb_clean_centered</span> <span class="op">&lt;-</span> <span class="va">tb_clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_centered <span class="op">=</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">age_centered</span>, .after <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">age_updated</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tb_clean_grouped &lt;- groupedData(</span></span>
<span><span class="co">#   abelisa ~ time | id, </span></span>
<span><span class="co">#   data = tb_clean_centered</span></span>
<span><span class="co">#   )</span></span>
<span></span>
<span></span>
<span><span class="va">tb_after_7_centered</span> <span class="op">&lt;-</span> <span class="va">tb_after_7</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_centered <span class="op">=</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">age_centered</span>, .after <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">age_updated</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tb_after_7_grouped &lt;- groupedData(</span></span>
<span><span class="co">#   abelisa ~ time | id, </span></span>
<span><span class="co">#   data = tb_after_7_centered</span></span>
<span><span class="co">#   )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># # consntat corresponding to intial values</span></span>
<span><span class="co"># c_const &lt;- 100</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Nonlinear function with log-parameters and fixed c</span></span>
<span><span class="co"># f_model_log &lt;- function(time, log_phi_S, log_phi_L, log_delta_A, log_delta_S, log_delta_L) {</span></span>
<span><span class="co">#   phi_S &lt;- exp(log_phi_S)</span></span>
<span><span class="co">#   phi_L &lt;- exp(log_phi_L)</span></span>
<span><span class="co">#   delta_A &lt;- exp(log_delta_A)</span></span>
<span><span class="co">#   delta_S &lt;- exp(log_delta_S)</span></span>
<span><span class="co">#   delta_L &lt;- exp(log_delta_L)</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   c_const * exp(-delta_A * time) +</span></span>
<span><span class="co">#     (phi_S / (delta_A - delta_S)) * exp(-delta_S * time) +</span></span>
<span><span class="co">#     (phi_L / (delta_A - delta_L)) * exp(-delta_L * time)</span></span>
<span><span class="co"># }</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Starting values (log-scale for parameters)</span></span>
<span><span class="co"># start_vals &lt;- c(</span></span>
<span><span class="co">#   log_phi_S = log(50),</span></span>
<span><span class="co">#   log_phi_L = log(30),</span></span>
<span><span class="co">#   log_delta_A = log(0.0005),</span></span>
<span><span class="co">#   log_delta_S = log(0.005),</span></span>
<span><span class="co">#   log_delta_L = log(0.001)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Fit nlme model:</span></span>
<span><span class="co"># nlme_model &lt;- nlme(</span></span>
<span><span class="co">#   abelisa ~ f_model_log(time, log_phi_S, log_phi_L, log_delta_A, log_delta_S, log_delta_L),</span></span>
<span><span class="co">#   </span></span>
<span><span class="co">#   # Data: </span></span>
<span><span class="co">#   data = tb_after_7_centered,</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   # Fixed effects:</span></span>
<span><span class="co">#   fixed = list(</span></span>
<span><span class="co">#     log_phi_S ~ sex + age_centered + bmi + country,</span></span>
<span><span class="co">#     log_phi_L ~ sex + age_centered + bmi + country,</span></span>
<span><span class="co">#     log_delta_A ~ sex + age_centered + bmi + country,</span></span>
<span><span class="co">#     log_delta_S + log_delta_L ~ 1  # no covariates on delta S and L params</span></span>
<span><span class="co">#   ),</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   # Random effects on log_phi_S, log_phi_L, per subject</span></span>
<span><span class="co">#   random = pdDiag(log_phi_S + log_phi_L ~ 1 | id),</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   start = start_vals,</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   control = nlmeControl(</span></span>
<span><span class="co">#     pnlsTol = 0.1, </span></span>
<span><span class="co">#     msMaxIter = 100, </span></span>
<span><span class="co">#     msMaxEval = 1000</span></span>
<span><span class="co">#   )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># summary(nlme_model)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-pasin2019" class="csl-entry" role="listitem">
Pasin, Chloé, Irene Balelli, Thierry Van Effelterre, Viki Bockstal, Laura Solforosi, Mélanie Prague, Macaya Douoguih, and Rodolphe Thiébaut. 2019. <span>“Dynamics of the Humoral Immune Response to a Prime-Boost Ebola Vaccine: Quantification and Sources of Variation.”</span> Edited by Mark T. Heise. <em>Journal of Virology</em> 93 (18). <a href="https://doi.org/10.1128/jvi.00579-19">https://doi.org/10.1128/jvi.00579-19</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>